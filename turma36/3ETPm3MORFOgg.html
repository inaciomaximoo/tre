<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Simulador de Provas Personalizado</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=Roboto+Mono&display=swap" rel="stylesheet">
    
    <audio id="correctSound" src="correct.mp3" preload="auto"></audio>
    <audio id="wrongSound" src="wrong.mp3" preload="auto"></audio>
 
    <style>
        :root {
            --bg-main: #f0f2f5;
            --bg-card: #ffffff;
            --text-primary: #333333;
            --text-secondary: #555555;
            --primary-color: #3a86ff; 
            --primary-light: #69a5ff;
            --primary-dark: #005cbb;
            --accent-color: #2ecc71;
            --accent-light: #e6ffee;
            --danger-color: #e74c3c;
            --danger-light: #ffebee;
            --warning-color: #FF9800; 
            --warning-light: #FFF3E0;
            --border-color: #d1d9e6;
            --shadow-color: rgba(0, 0, 0, 0.1);
            --font-main: 'Poppins', sans-serif;
            --font-mono: 'Roboto Mono', monospace;
            --border-radius-main: 12px;
            --transition-speed: 0.3s;
            --purple-accent: #7c4dff; 
        } 

        .dark-mode {
            --bg-main: #1e1e2f;
            --bg-card: #2a2a3a;
            --text-primary: #e0e0e0;
            --text-secondary: #9e9e9e;
            --primary-color: #7c4dff; 
            --primary-light: #9d7bff;
            --primary-dark: #5e35b1;
            --accent-color: #00e676;
            --accent-light: rgba(0, 230, 118, 0.1);
            --danger-color: #ff5252;
            --danger-light: rgba(255, 82, 82, 0.1);
            --warning-color: #FFA726;
            --warning-light: rgba(255, 167, 38, 0.15);
            --border-color: #424242;
            --shadow-color: rgba(0, 0, 0, 0.4);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: var(--font-main);
            background-color: var(--bg-main);
            color: var(--text-primary);
            line-height: 1.6;
            transition: background-color var(--transition-speed) ease, color var(--transition-speed) ease;
            padding: 20px 15px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .container {
            width: 100%;
            max-width: 800px;
            margin: 20px auto;
            background: var(--bg-card);
            border-radius: var(--border-radius-main);
            box-shadow: 0 8px 25px var(--shadow-color);
            padding: 25px;
            border: 1px solid var(--border-color);
            transition: background-color var(--transition-speed) ease, border-color var(--transition-speed) ease;
        }
        
        .header {
            display: flex;
            align-items: center; 
            margin-bottom: 25px;
            gap: 15px;
            width: 100%;
        }
        
        #quizPage .header {
            flex-direction: row; 
            justify-content: space-between; 
        }
        #quizPage .header h1#quizTitle {
            margin-bottom: 0; 
            text-align: left; 
            flex-grow: 1; 
        }
        #quizPage .header .dark-mode-toggle {
            width: auto; 
            margin-bottom: 0;
        }

        
        #resultsPage .header {
            flex-direction: row;
            justify-content: space-between;
            align-items: center;
        }
        #resultsPage .header h1 {
            margin-bottom: 0; 
        }
        #resultsPage .header .dark-mode-toggle {
            margin-bottom: 0; 
            width: auto; 
        }


        h1, h2, h3, h4 {
            color: var(--primary-color);
            font-weight: 700;
            margin-bottom: 15px;
        }
        h1 { font-size: 1.8rem; text-align: center; }
        h2 { font-size: 1.5rem; }
        h3 { font-size: 1.3rem; text-align: center; }
        h4 { font-size: 1.1rem; color: var(--text-secondary); font-weight: 600; }

        .dark-mode-toggle {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 25px;
            padding: 8px 12px; 
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            transition: background-color var(--transition-speed) ease, border-color var(--transition-speed) ease, color var(--transition-speed) ease;
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--text-secondary);
            box-shadow: 0 2px 5px var(--shadow-color);
            overflow: hidden; 
        }
        
        .dark-mode-toggle:hover {
            background-color: var(--primary-color);
            color: #ffffff;
            border-color: var(--primary-dark);
        }
        .dark-mode .dark-mode-toggle:hover {
            color: #ffffff;
        }

        .icon-container {
            position: relative;
            width: 20px; 
            height: 20px; 
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        .moon-icon, .sun-icon {
            position: absolute;
            transition: opacity 0.3s ease-in-out, transform 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55); 
            font-size: 1rem; 
            line-height: 1;
        }
        .sun-icon {
            opacity: 0;
            transform: translateY(100%) rotate(90deg) scale(0.5); 
        }
        .moon-icon {
            opacity: 1;
            transform: translateY(0) rotate(0deg) scale(1);
        }
        .dark-mode .sun-icon {
            opacity: 1;
            transform: translateY(0) rotate(0deg) scale(1);
        }
        .dark-mode .moon-icon {
            opacity: 0;
            transform: translateY(-100%) rotate(-90deg) scale(0.5); 
        }
        

        .question-container {
            background: var(--bg-card);
            border-radius: var(--border-radius-main);
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
            transition: border-color var(--transition-speed) ease, background-color var(--transition-speed) ease;
        }

        .question-container.correct {
            border-left: 6px solid var(--accent-color);
            background-color: var(--accent-light);
        }
        .dark-mode .question-container.correct {
            background-color: rgba(0, 230, 118, 0.05);
        }

        .question-container.incorrect {
            border-left: 6px solid var(--danger-color);
            background-color: var(--danger-light);
        }
        .dark-mode .question-container.incorrect {
            background-color: rgba(255, 82, 82, 0.05);
        }

        .question-number {
            font-size: 1rem;
            margin-bottom: 10px;
            color: var(--primary-color);
            font-weight: 600;
            display: flex; 
            align-items: center; 
        }
        .mistake-stars-container { 
            margin-left: 10px;
            display: inline-flex;
            align-items: center;
        }
        .mistake-stars { 
            font-size: 0.9em; 
            color: var(--purple-accent); 
        }
        .mistake-stars-label {
            font-size: 0.8em;
            color: var(--purple-accent);
            font-weight: normal; 
            margin-left: 4px;
        }


        .question-text {
            margin-bottom: 20px;
            white-space: pre-line;
            font-family: var(--font-main);
            line-height: 1.7;
            font-size: 1.1rem;
            color: var(--text-primary);
        }

        .question-text .ascii-table {
            font-family: var(--font-mono);
            font-size: 0.9rem;
            background-color: var(--bg-main);
            padding: 1em;
            border-radius: 8px;
            overflow-x: auto;
            margin-top: 1em;
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .question-image {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin: 15px 0;
            display: block;
            box-shadow: 0 4px 10px var(--shadow-color);
            border: 1px solid var(--border-color);
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .option {
            display: flex;
            align-items: flex-start;
            padding: 15px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            background: transparent;
            cursor: pointer;
            transition: border-color var(--transition-speed) ease, background-color var(--transition-speed) ease, transform 0.2s ease;
            font-size: 1rem;
            line-height: 1.5;
        }

        .option:hover {
            border-color: var(--primary-color);
            background-color: var(--primary-light-translucent, rgba(58, 134, 255, 0.1));
            transform: translateY(-2px);
        }
        .dark-mode .option:hover {
            background-color: rgba(124, 77, 255, 0.15);
        }

        .option input[type="radio"] {
            display: none;
        }

        .option-letter-styled {
            font-weight: 700;
            color: var(--primary-color);
            margin-right: 10px;
            line-height: 1.5; 
        }

        .option-actual-text {
            flex: 1;
            color: var(--text-secondary);
            line-height: 1.5;
        }

        .correct-answer, .explanation {
            margin-top: 15px;
            padding: 12px;
            border-radius: 8px;
            font-size: 0.95rem;
            line-height: 1.5;
        }

        .correct-answer {
            color: var(--accent-color);
            font-weight: 600;
            background-color: var(--accent-light);
            border-left: 4px solid var(--accent-color);
            display: none;
        }

        .explanation {
            background-color: var(--bg-main);
            border: 1px solid var(--border-color);
            color: var(--text-secondary);
            display: none;
        }

        .navigation {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 25px 0;
        }

        .nav-button, .action-button, .feedback-continue, .popup-button, .danger-button { 
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: #ffffff;
            cursor: pointer;
            font-family: var(--font-main);
            font-weight: 600;
            font-size: 1rem;
            transition: all var(--transition-speed) ease;
            width: 100%;
            text-align: center;
            box-shadow: 0 4px 10px var(--shadow-color);
            display: inline-flex; 
            align-items: center;
            justify-content: center;
        }
        .dark-mode .nav-button, .dark-mode .action-button, .dark-mode .feedback-continue, .dark-mode .popup-button, .dark-mode .danger-button {
            color: #ffffff;
        }

        .nav-button:hover, .action-button:hover, .feedback-continue:hover, .popup-button:hover, .danger-button:hover {
            background: linear-gradient(135deg, var(--primary-light), var(--primary-color));
            transform: translateY(-2px);
            box-shadow: 0 6px 15px var(--shadow-color);
        }
        .danger-button {
            background: linear-gradient(135deg, var(--danger-color), #c0392b ); 
        }
        .danger-button:hover {
            background: linear-gradient(135deg, var(--danger-light), var(--danger-color));
        }
        .danger-button .icon, .action-button .icon { 
             margin-right: 8px;
        }
        
        .expand-button { 
            padding: 10px 18px;
            border: 1px solid var(--purple-accent); 
            border-radius: 8px;
            background: var(--text-secondary);
            color: var(--bg-card);
            cursor: pointer;
            font-family: var(--font-main);
            font-weight: 600;
            font-size: 0.9rem;
            transition: all var(--transition-speed) ease;
            width: auto; 
            display: inline-flex;
            align-items: center;
            margin: 0 auto 15px auto;
            box-shadow: 0 2px 5px var(--shadow-color);
        }
        .dark-mode .expand-button {
            background: var(--text-secondary); 
            color: var(--bg-card);
            border: 1px solid var(--primary-light); 
        }
        .expand-button:hover {
            background: var(--primary-color);
            border-color: var(--primary-color); 
            color: #ffffff;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px var(--shadow-color);
        }
        .expand-button .icon {
            margin-right: 8px;
            display: inline-block;
            transition: transform 0.3s ease;
        }
        .expand-button.expanded .icon {
            transform: rotate(180deg);
        }

        .nav-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            background: var(--border-color);
            color: var(--text-secondary);
            box-shadow: none;
        }

        .instant-feedback {
            padding: 12px;
            margin: 20px 0;
            border-radius: 8px;
            font-weight: 600;
            text-align: center;
            display: none;
            font-size: 1rem;
            border-left-width: 6px;
            border-left-style: solid;
        }

        .instant-feedback.correct {
            background-color: var(--accent-light);
            color: var(--accent-color);
            border-left-color: var(--accent-color);
        }

        .instant-feedback.incorrect {
            background-color: var(--danger-light);
            color: var(--danger-color);
            border-left-color: var(--danger-color);
        }
        
        /* Estilos para o Popup de Congratulações (já presentes no seu CSS original) */
        .congrats-popup {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.85); /* Fundo mais escuro para destaque */
            display: flex;
            flex-direction: column; /* Para alinhar o conteúdo verticalmente */
            justify-content: center;
            align-items: center;
            z-index: 2000; /* Acima de outros popups */
            padding: 15px; /* Espaçamento para telas menores */
        }

        .congrats-content {
            background: var(--bg-card);
            padding: 30px; /* Mais padding interno */
            border-radius: var(--border-radius-main);
            max-width: 90%; /* Responsividade */
            width: 400px; /* Largura fixa para consistência */
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5); /* Sombra mais pronunciada */
            border: 1px solid var(--primary-color); /* Borda temática */
        }

        .congrats-message {
            font-size: 1.4rem; /* Tamanho da fonte da mensagem */
            margin-bottom: 20px;
            color: var(--primary-color); /* Cor temática */
            font-weight: bold;
        }
        .random-iframe {
            margin: 20px 0; /* Espaçamento para o iframe */
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .random-iframe iframe {
            border-radius: 8px; /* Bordas arredondadas para o iframe */
        }

        .close-popup-button { /* Reutilizando a classe para o botão de fechar */
            margin-top: 20px;
            padding: 10px 20px;
            background: var(--primary-color);
            color: #ffffff;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: background-color var(--transition-speed) ease;
        }
        .dark-mode .close-popup-button {
            color: #ffffff; /* Garante contraste no modo escuro */
        }
        .close-popup-button:hover {
            background: var(--primary-dark);
        }


        .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0,0,0,0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0s 0.3s;
            padding: 20px;
        }
        .popup-overlay.active {
            opacity: 1;
            visibility: visible;
            transition: opacity 0.3s ease, visibility 0s 0s;
        }
        .popup-content {
            background-color: var(--bg-card);
            padding: 25px;
            border-radius: var(--border-radius-main);
            box-shadow: 0 10px 30px var(--shadow-color);
            width: 95%;
            max-width: 450px;
            max-height: 90vh;
            overflow-y: auto;
            text-align: center;
            position: relative;
            border: 1px solid var(--border-color);
            transform: scale(0.95);
            transition: transform 0.3s ease;
        }
        #questionDetailPopup .popup-content { 
            max-width: 700px; 
            text-align: left;
        }
        #questionDetailPopup .popup-close-button { 
            position: absolute; 
            top: 15px; 
            right: 15px; 
            background: transparent; 
            color: var(--text-secondary); 
            font-size: 1.75rem; 
            border: none; 
            padding: 5px;
            line-height: 1;
            cursor: pointer;
        }
        #questionDetailPopup .popup-close-button:hover {
             color: var(--primary-color);
             background: transparent; 
        }


        .popup-overlay.active .popup-content {
            transform: scale(1);
        }
        .popup-close-button { /* Estilo geral para botões de fechar popup, se não for o do congrats */
            margin-top: 20px;
            padding: 10px 20px;
            background-color: var(--text-secondary);
            color: var(--bg-card);
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: background-color var(--transition-speed) ease;
            width: auto;
            display: inline-block;
        }
        .dark-mode .popup-close-button {
            background-color: var(--border-color);
            color: var(--text-primary);
        }
        .popup-close-button:hover {
            background-color: var(--danger-color);
            color: white;
        }
        #quizOptionsPopupTitle {
            color: var(--primary-color);
            margin-bottom: 10px;
            font-size: 1.4rem;
        }
        #quizOptionsPopupSubtitle {
            color: var(--text-secondary);
            margin-bottom: 20px;
            font-size: 1rem;
            font-weight: 500;
        }
        #quizOptionsPopupButtons {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        .feedback-popup {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0,0,0,0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000; 
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0s 0.3s;
            padding: 20px;
        }
        .feedback-popup.active {
            opacity: 1;
            visibility: visible;
            transition: opacity 0.3s ease, visibility 0s 0s;
        }
        .feedback-content {
            background-color: var(--bg-card);
            padding: 30px;
            border-radius: var(--border-radius-main);
            box-shadow: 0 10px 30px var(--shadow-color);
            width: 95%;
            max-width: 500px;
            max-height: 85vh;
            overflow-y: auto;
            text-align: center;
            position: relative;
            border: 1px solid var(--border-color);
        }
        .feedback-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 1.75rem;
            cursor: pointer;
            color: var(--text-secondary);
            padding: 0;
            line-height: 1;
        }
        .feedback-close:hover {
            color: var(--primary-color);
        }
        .feedback-title {
            color: var(--primary-color);
            margin-bottom: 20px;
            font-size: 1.5rem;
            font-weight: 700;
        }
        .feedback-stats {
            margin: 12px 0;
            font-size: 1rem;
            color: var(--text-primary);
        }
        .feedback-stats span {
            font-weight: 600;
        }
        .feedback-correct {
            color: var(--accent-color);
        }
        .feedback-incorrect {
            color: var(--danger-color);
        }
        .feedback-percentage {
            font-size: 1.1rem;
            margin: 15px 0 25px 0;
            font-weight: 500;
            color: var(--text-primary);
        }
        #feedbackPercentageValue { 
            color: var(--primary-color);
            font-weight: 700;
            font-size: 1.6rem;
            margin-left: 8px;
        }
        #feedbackMistakesList {
            margin-top: 20px;
            max-height: 35vh;
            overflow-y: auto;
            border-top: 1px solid var(--border-color);
            padding-top: 20px;
            text-align: left;
        }
        #feedbackMistakesList h4 {
            font-size: 1rem;
            color: var(--text-secondary);
            margin-bottom: 15px;
            font-weight: 600;
        }
        .feedback-mistake-item {
            margin-bottom: 12px;
            padding: 12px;
            background-color: var(--bg-main);
            border-radius: 6px;
            border-left: 4px solid var(--danger-color);
            font-size: 0.9rem;
        }
        .dark-mode .feedback-mistake-item {
            background-color: rgba(255,255,255,0.03);
        }
        .feedback-mistake-question {
            font-weight: 600;
            margin-bottom: 6px;
            color: var(--text-primary);
        }
        .feedback-mistake-option {
            padding: 4px 0;
            font-size: 0.85rem;
            color: var(--text-secondary);
            line-height: 1.4;
        }
        .feedback-mistake-option.feedback-mistake-correct {
            color: var(--accent-color);
            border-left: none;
            background-color: transparent;
        }
        .feedback-mistake-option.feedback-mistake-selected {
            color: var(--danger-color);
            border-left: none;
            background-color: transparent;
        }
        .feedback-continue {
            margin-top: 30px;
        }

        .progress-container {
            width: 100%;
            background-color: var(--bg-main);
            border-radius: 8px;
            margin: 20px 0;
            height: 12px;
            border: 1px solid var(--border-color);
            overflow: hidden;
        }
        .progress-bar {
            height: 100%;
            background-color: var(--primary-color);
            border-radius: 0;
            width: 0%;
            transition: width 0.5s ease;
        }
        
        #results-main-box {
            background-color: var(--bg-card);
            padding: 20px;
            border-radius: var(--border-radius-main);
            box-shadow: 0 6px 20px var(--shadow-color);
            border-top: 5px solid transparent; 
            margin-top: 25px; 
            transition: border-color var(--transition-speed) ease;
        }
        .results-box-bad { border-top-color: var(--danger-color); }
        .results-box-average { border-top-color: var(--warning-color); }
        .results-box-good { border-top-color: var(--accent-color); }

        .stat-card {
            background: var(--bg-main); 
            color: var(--text-primary);
            border-radius: var(--border-radius-main);
            padding: 20px;
            box-shadow: 0 4px 10px var(--shadow-color);
            border: 1px solid var(--border-color);
            margin-bottom: 25px; 
        }
        .dark-mode .stat-card {
            background: var(--bg-card); 
        }
        .dark-mode .stat-card h3, .dark-mode .stat-card h4 {
            color: var(--primary-color); 
        }
        .stat-card h3, .stat-card h4 {
            text-align: center;
            margin-bottom: 15px;
        }

        #main-performance-card .chart-container {
            height: 280px; 
            max-height: 40vh; 
            position: relative; 
        }
        .stat-card .chart-container { 
            height: 200px; 
            position: relative;
        }
        .chart-container canvas { 
            width: 100% !important;
            height: 100% !important;
        }
        
        .final-score-container {
            text-align: center;
            margin-bottom: 20px; 
        }
        .final-score-label {
            display: block;
            font-size: 1.1rem;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }
        .final-percentage { 
            text-align: center;
            margin-top: 10px; 
            margin-bottom: 25px; 
            color: var(--text-secondary);
            font-size: 1rem;
        }
        .final-percentage strong {
            color: var(--text-primary); 
            font-weight: 600;
        }
        .dark-mode .final-percentage strong {
            color: var(--text-primary);
        }

        .final-score-value-box {
            display: inline-block;
            padding: 15px 30px;
            border-radius: var(--border-radius-main);
            font-size: 2.5rem;
            font-weight: 700;
            line-height: 1;
            transition: background-color var(--transition-speed) ease, color var(--transition-speed) ease, border-color var(--transition-speed) ease;
            border: 2px solid transparent;
            min-width: 150px;
        }
        .final-score-value-box.score-bad {
            background-color: var(--danger-light);
            color: var(--danger-color);
            border-color: var(--danger-color);
        }
        .final-score-value-box.score-average {
            background-color: var(--warning-light);
            color: var(--warning-color);
            border-color: var(--warning-color);
        }
        .final-score-value-box.score-good {
            background-color: var(--accent-light);
            color: var(--accent-color);
            border-color: var(--accent-color);
        }
        
        .stats-grid {
            display: grid;
            gap: 20px;
            grid-template-columns: 1fr; 
        }
         .stats-grid > .stat-card {
            margin-bottom: 0; 
        }
        .additional-stats, .questions-review {
            margin-top: 25px; 
        }

        .questions-review {
            text-align: center;
        }
        .analysis-content-box {
            background-color: var(--bg-main);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-main);
            padding: 20px;
            margin-top: 15px;
            text-align: left;
        }
        .dark-mode .analysis-content-box {
            background-color: rgba(0,0,0,0.1);
        }
        
        .analysis-correct-answer {
            margin-top: 15px;
            padding: 10px;
            background-color: var(--accent-light);
            border-radius: 6px;
            border-left: 4px solid var(--accent-color);
            color: var(--accent-color); 
            font-size: 0.95rem;
        }
        .dark-mode .analysis-correct-answer {
             background-color: rgba(0, 230, 118, 0.1);
        }
        .analysis-correct-answer strong {
            color: var(--accent-color); 
            font-weight: bold;
        }


        #resultsPage .actions {
            display: flex;
            flex-direction: column; 
            align-items: center; 
            gap: 15px;
            margin-top: 30px; 
            width: 100%;
        }
        #resultsPage .actions .action-button {
            width: 100%; 
            max-width: 300px; 
            flex-grow: 0;
        }

        .reset-stats-container { 
            text-align: center;
            margin-top: 25px; 
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }
         #resetStatsBtn.small-reset-button { 
            font-size: 0.85rem;  
            padding: 8px 15px;   
            max-width: 280px;   
        }
        #resetStatsBtn { 
            background: linear-gradient(135deg, var(--danger-color), #c0392b);
        }
        #resetStatsBtn:hover {
             background: linear-gradient(135deg, var(--danger-light), var(--danger-color));
        }
         #resetStatsBtn .icon {
            margin-right: 6px;
        }
        #resetStatsBtn:disabled {
            background: var(--border-color);
            opacity: 0.5;
            cursor: not-allowed;
        }


        @media (min-width: 768px) {
            .container { padding: 35px; }
            #main-performance-card .chart-container { height: 350px; }
            .stat-card .chart-container { height: 250px; } 
            .stats-grid { grid-template-columns: 1fr 1fr; }
            .additional-charts { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
            .additional-charts .stat-card { margin-bottom: 0; }
            .final-score-value-box { padding: 20px 40px; font-size: 3rem; }
            
            #resultsPage .actions {
                 flex-direction: row;
                 justify-content: center; 
            }
             #resultsPage .actions .action-button {
                 width: auto; 
                 flex-basis: 220px; 
                 max-width: 250px;
            }
             #resetStatsBtn.small-reset-button { 
                 width: auto;
                 flex-basis: auto; 
                 max-width: 300px;
            }
        }
        @media (max-width: 600px) {
            #quizPage .header { flex-direction: column; align-items: center; }
            #quizPage .header h1#quizTitle { text-align: center; margin-bottom: 15px; }
            #quizPage .header .dark-mode-toggle { width: 100%; }
        }
        @media (max-width: 350px) {
            body { font-size: 14px; padding: 10px; }
            h1 { font-size: 1.3rem; }
            .question-container, .question-result { padding: 12px; }
            .option { padding: 10px; font-size: 0.95rem; }
            .nav-button, .action-button, .feedback-continue, .expand-button, .popup-button { padding: 10px; font-size: 0.95rem; }
            .final-score-value-box { font-size: 2rem; padding: 10px 20px;}
            #main-performance-card .chart-container { height: 250px; }
            .stat-card .chart-container { height: 180px; } 
            #resetStatsBtn.small-reset-button { font-size: 0.8rem; padding: 8px 12px; }
        }

    </style>
</head>
<body>
    <div class="container">
        <div id="quizPage" style="display:none;"> 
            <div class="header">
                <h1 id="quizTitle">Simulador de Provas</h1> 
                <button class="dark-mode-toggle" id="darkModeToggle">
                    <span class="icon-container">
                        <span class="moon-icon">🌙</span>
                        <span class="sun-icon">☀️</span>
                    </span>
                    <span id="darkModeText">Modo Escuro</span>
                </button>
            </div>
            <div class="progress-container">
                <div class="progress-bar" id="progressBar"></div>
            </div>
            <div id="currentQuestion"></div>
            <div class="instant-feedback" id="instantFeedback"></div>
            <div class="navigation">
                <button onclick="previousQuestion()" id="prevBtn" class="nav-button" disabled>Anterior</button>
                <button onclick="nextQuestion()" id="nextBtn" class="nav-button">Próxima</button>
                <button onclick="finishTest()" id="finishBtn" class="nav-button" style="display: none;">Finalizar Prova</button>
            </div>
        </div>

        <div id="resultsPage" style="display: none;">
            <div class="header"> 
                <h1 id="resultsTitle">Resultados da Prova</h1>  
                <button class="dark-mode-toggle" id="darkModeToggleResults">
                     <span class="icon-container"> 
                        <span class="moon-icon">🌙</span>
                        <span class="sun-icon">☀️</span>
                    </span>
                    <span id="darkModeTextResults">Modo Escuro</span>
                </button>
            </div>

            <div id="results-main-box"> 
                <div class="results-header">
                    <div class="final-score-container">
                        <span class="final-score-label">Sua Nota Final:</span>
                        <div id="finalScoreText" class="final-score-value-box"></div>
                    </div>
                    <div class="final-percentage" id="finalPercentageText"></div>
                </div>

                <div class="stat-card" id="main-performance-card">
                    <h3>Desempenho Geral</h3>
                    <div class="chart-container">
                        <canvas id="performanceChart"></canvas>
                    </div>
                </div>

                <div class="stats-grid">
                    <div class="stat-card" id="areasChartCard">
                        <h3>Acertos por Área</h3>
                        <div class="chart-container">
                            <canvas id="areasChart"></canvas>
                        </div>
                    </div>
                    <div class="stat-card">
                        <h3>Progresso nas Tentativas</h3>
                        <div class="chart-container">
                            <canvas id="progressChart"></canvas>
                        </div>
                    </div>
                     <div class="stat-card">
                        <h3>Questões com Erros</h3>
                        <div class="chart-container">
                            <canvas id="mistakesChart"></canvas>
                        </div>
                    </div>
                </div>

                <div class="additional-stats stat-card"> 
                    <h3>Estatísticas Adicionais</h3>
                    <div class="additional-charts">
                        <div class="stat-card">
                            <h4 id="questionSizeChartTitle">Tamanho de Questão</h4>
                            <div class="chart-container">
                                <canvas id="questionSizeChart"></canvas> 
                            </div>
                        </div>
                        <div class="stat-card">
                            <h4>Tempo por Questão (Simulado)</h4>
                            <div class="chart-container">
                                <canvas id="timePerQuestionChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="questions-review stat-card"> 
                    <h3>Análise Detalhada por Questão</h3>
                    <button class="expand-button" id="toggleAnalysisBtn">
                        <span class="icon">&#x25BC;</span>Expandir Análise
                    </button>
                    <div class="analysis-content-box" id="analysisBox" style="display: none;">
                        <div id="questionsAnalysis"></div>
                    </div>
                </div>

                <div class="actions">
                    <button onclick="startNewAttempt(false)" class="action-button">Nova Tentativa</button> <button onclick="startNewAttempt(true)" class="action-button">Revisar Erros</button> </div>
                <div class="reset-stats-container">
                    <button id="resetStatsBtn" class="action-button danger-button small-reset-button" disabled>
                        <span class="icon">🗑️</span> Resetar Progresso
                    </button>
                </div>
            </div> 
        </div>
    </div>

    <div class="feedback-popup" id="feedbackPopup">
        <div class="feedback-content">
            <button class="feedback-close" id="closeFeedback">×</button>
            <h3 class="feedback-title">Seu desempenho no bloco</h3>
            <div class="feedback-stats">
                Você respondeu <span id="feedbackTotal">0</span> questões neste bloco.
            </div>
            <div class="feedback-stats">
                <span class="feedback-correct">Acertos: <span id="feedbackCorrect">0</span></span> | 
                <span class="feedback-incorrect">Erros: <span id="feedbackIncorrect">0</span></span>
            </div>
            <div class="feedback-percentage">
                Taxa de acertos: <span id="feedbackPercentageValue">0</span>%
            </div>
            <div id="feedbackMistakesList"></div>
            <button class="feedback-continue" id="continueButton">Continuar</button>
        </div>
    </div>

    <div class="popup-overlay" id="quizStartOptionsPopup">
        <div class="popup-content">
            <h3 id="quizOptionsPopupTitle">Iniciar Simulado</h3>
            <p id="quizOptionsPopupSubtitle"></p>
            <div id="quizOptionsPopupButtons">
            </div>
            <button class="popup-close-button" onclick="closeQuizOptionsPopup()">Cancelar</button>
        </div>
    </div>
    
    <div class="popup-overlay" id="questionDetailPopup">
        <div class="popup-content" style="max-width: 700px; text-align: left;">
            <button class="popup-close-button" onclick="closeQuestionDetailPopup()" >×</button>
            <div id="questionDetailContent">
            </div>
        </div>
    </div>


    <script>
        // ID Fixo para o simulado embutido
        const EMBEDDED_QUIZ_ID = 'simulado_principal_embutido';
        let currentFileId = EMBEDDED_QUIZ_ID; // Usar o ID fixo globalmente

        // Chave para estatísticas no localStorage (mantida)
        const LOCAL_STORAGE_STATS_PREFIX = 'quizApp_stats_';

        // Questões embutidas diretamente no código
        const embeddedQuestionsSource = [
  {
    "enunciado": "Levando em consideração a formação dos neutrófilos na medula óssea e a maturação de seus precursores, das situações abaixo qual pode caracterizar desvio a esquerda escalonado?",
    "imagem": null,
    "alternativas": {
      "a": "Presença de bastonetes em maior quantidade que neutrófilos.",
      "b": "Presença de pró-mielócito em maior quantidade que mielócitos.",
      "c": "Presença de mielócitos em maior quantidade que metamielócitos.",
      "d": "Presença de bastonetes acima do valor de referência em maior quantidade que metamielócitos."
    },
    "correta": "d"
  },
  {
    "enunciado": "Qual o nome do leucócito que quando visto na microscopia óptica, não é possível observar seu núcleo por estar coberto por grânulos citoplasmáticos pretos?",
    "imagem": null,
    "alternativas": {
      "a": "Monócito.",
      "b": "Neutrófilo.",
      "c": "Eosinófilo.",
      "d": "Basófilo."
    },
    "correta": "d"
  },
  {
    "enunciado": "Quanto a morfologia dos neutrófilos, é possível afirmar que:",
    "imagem": null,
    "alternativas": {
      "a": "Núcleo bilobulado, excêntrico, cromatina grosseira e homogênea, nucléolos ausentes.  Citoplasma eosinofílico, com granulações numerosa e moderadamente grosseiras.",
      "b": "Possui núcleo com três a cinco lóbulos e excêntrico, cromatina grosseira e homogênea, nucléolos ausentes.  Citoplasma acidófilo, com granulações delicadas presentes em alta quantidade.",
      "c": "Núcleo com três a cinco lóbulos e excêntrico, cromatina grosseira e homogênea, nucléolos ausentes.  Citoplasma eosinofílico, com granulações numerosas e moderadamente grosseiras.",
      "d": "Núcleo bilobulado de forma bizarra e excêntrico, de difícil visibilização, cromatina grosseira e homogênea, nucléolos ausentes.  Citoplasma com coloração escura devido a presença de muitas granulações basófilas grosseiras."
    },
    "correta": "b"
  },
  {
    "enunciado": "Qual leucócito pode estar acima do valor de referência em doenças inflamatórias crônicas?",
    "imagem": null,
    "alternativas": {
      "a": "Linfócito.",
      "b": "Eosinófilo.",
      "c": "Monócito.",
      "d": "Basófilo."
    },
    "correta": "c"
  },
  {
    "enunciado": "Levando em consideração a formação dos neutrófilos na medula óssea e a maturação de seus precursores, qual das situações abaixo pode caracterizar desvio à esquerda não escalonado?",
    "imagem": null,
    "alternativas": {
      "a": "Presença de bastonetes em maior quantidade que metamielócitos.",
      "b": "Presença de mielócitos em maior quantidade que metamielócitos.",
      "c": "Presença de metamielócitos em maior quantidade que mielócitos.",
      "d": "Presença de neutrófilos em maior quantidade que bastonetes."
    },
    "correta": "b"
  },
  {
    "enunciado": "Qual leucócito pode não ser encontrado no sangue periférico e sua ausência não tem significado clinico?",
    "imagem": null,
    "alternativas": {
      "a": "Basófilo.",
      "b": "Linfócito.",
      "c": "Monócito.",
      "d": "Eosinófilo."
    },
    "correta": "a"
  },
  {
    "enunciado": "Doenças alérgicas e parasitárias apresentarão em um leucograma possivelmente uma:",
    "imagem": null,
    "alternativas": {
      "a": "Neutropenia.",
      "b": "Linfocitose.",
      "c": "Eosinofilia.",
      "d": "Monocitopenia."
    },
    "correta": "c"
  },
  {
    "enunciado": "Com relação aos achados no hemograma durante a anemia megaloblástica, analise as afirmativas a seguir:\nI- O HCM estará aumentado porque a quantidade de hemoglobina (peso) é proporcional ao tamanho celular e a quantidade reduzida de eritrócitos no sangue periférico do paciente.\nII- Presença de eritroblastos no sangue periférico (observação incluída no laudo laboratorial).\nIII- CHCM estará diminuído devido à redução de eritrócitos circulantes no sangue periférico.\nAssinale a alternativa que contenha as afirmativas corretas:",
    "imagem": null,
    "alternativas": {
      "a": "Somente a afirmativa III está correta.",
      "b": "Somente as afirmativas II e III estão corretas.",
      "c": "Somente as afirmativas I e III estão corretas.",
      "d": "Somente as afirmativas I e II estão corretas."
    },
    "correta": "d"
  },
  {
    "enunciado": "Várias substâncias endógenas e exógenas atuam como fatores que estimulam a eritropoese.  Com relação a estes fatores assinale a alternativa correta.",
    "imagem": null,
    "alternativas": {
      "a": "A eritropoietina é um fator endógeno que atua na fase de proliferação que envolve o eritroblasto ortocromático, reticulócito e eritrócito, assim como na fase de maturação que envolve o pró-eritroblasto, eritroblasto basófilo e eritroblasto policromático.",
      "b": "A eritropoetina é um fator exógeno renal que atua na fase de proliferação que envolve o pró-eritroblasto, eritroblasto acidófilo e eritroblasto policromático, assim como na fase de maturação que envolve o eritroblasto ortocromático, reticulócito e eritrócito.",
      "c": "A eritropoietina e o folato, fatores exógenos, atuam na fase de proliferação da eritropoese que envolve o pró-eritroblasto, eritroblasto basófilo e eritroblasto policromático.",
      "d": "A vitamina B12 e o ferro, fatores exógenos, atuam na fase de proliferação e maturação, respectivamente."
    },
    "correta": "d"
  },
  {
    "enunciado": "A alteração indicada pelas setas azuis e pretas na imagem, se refere a:",
    "imagem": null,
    "alternativas": {
      "a": "Anisocitose, que é indicada através do VCM.",
      "b": "Poiquilocitose, que é observada na microscopia.",
      "c": "Poiquilocitose, que é indicada apenas através do RDW.",
      "d": "Anisocitose, que é indicada através do RDW."
    },
    "correta": "d"
  },
  {
    "enunciado": "A alteração indicada pelas setas pretas na imagem, se refere a:",
    "imagem": null,
    "alternativas": {
      "a": "Anisocitose, que é indicada através do VCM.",
      "b": "Poiquilocitose, que é observada na microscopia.",
      "c": "Poiquilocitose, que é indicada apenas através do RDW.",
      "d": "Anisocitose, que é indicada através do RDW."
    },
    "correta": "b"
  },
  {
    "enunciado": "A hematologia estuda, principalmente, os elementos figurados do sangue: hemáceas, leucócitos e plaquetas.  Estuda a produção e o estado de normalidade dos elementos do sangue.  Para isso alguns termos são utilizados. Assinale a alternativa que apresenta o conceito correto para o termo:",
    "imagem": null,
    "alternativas": {
      "a": "Microcitose é o termo utilizado para referir-se ao tamanho aumentado da hemácia por falta de vitamina B 12.",
      "b": "Hipocromia é o termo usado na hematologia para referir-se ao aumento da coloração dos eritrócitos ou hemácias.",
      "c": "Anisocitose é um termo da hematologia que significa disparidade do tamanho, principalmente nas hemácias.",
      "d": "Poiquilocitose é uma alteração na cor da hemácia (glóbulos vermelhos do sangue ou eritrócitos)."
    },
    "correta": "c"
  },
  {
    "enunciado": "De acordo com a Organização Mundial da Saúde, o parâmetro que indica anemia é a (o):",
    "imagem": null,
    "alternativas": {
      "a": "Dosagem de hemoglobina.",
      "b": "Contagem de eritrócitos.",
      "c": "Hematócrito.",
      "d": "Volume Corpuscular Médio."
    },
    "correta": "a"
  },
  {
    "enunciado": "Em uma anemia carencial por deficiência grave de ferro a observação esperada em uma extensão sanguínea será:",
    "imagem": null,
    "alternativas": {
      "a": "Macrocitose devido ao aumento do CHCM, hipocromia devido ao diminuição de HCM, ausência de anisocitose (RDW aumentado) e hematócrito acima do normal.",
      "b": "Macrocitose devido ao aumento do VCM, hipocromia devido a diminuição de CHCM, presença de anisocitose (RDW aumentado) e hematócrito acima do normal.",
      "c": "Microcitose devido a diminuição de VCM, hipocromia devido a diminuição de CHCM, presença de anisocitose (RDW aumentado) e hematócrito abaixo do normal.",
      "d": "Microcitose devido a diminuição de CHCM, hipocromia devido a diminuição de HCM, ausência de anisocitose (RDW diminuído) e hematócrito abaixo do normal."
    },
    "correta": "c"
  },
  {
    "enunciado": "Quando um indivíduo é acometido por osteoporose as vértebras são frequentemente atingidas.  São características que permitem identificar a vértebra lombar:",
    "imagem": null,
    "alternativas": {
      "a": "O processo espinhoso obtuso em relação ao processo transverso",
      "b": "O processo transverso com fossa articular para receber as costelas",
      "c": "O processo espinhosos paralelo ao plano horizontal",
      "d": "O corpo de igual volume ao segmento cervical"
    },
    "correta": "c"
  },
  {
    "enunciado": "Sobre as artérias coronária direita e interventricular anterior podemos afirmar:",
    "imagem": null,
    "alternativas": {
      "a": "São oriundas das aa.aorta e coronária esquerda respectivamente",
      "b": "Tratam-se de vasos que não sofrem anastomoses, nos dois casos",
      "c": "Não são ramos sujeitos a formação de placa de ateroma",
      "d": "Possuem derivações denominadas diagonais em ambos os casos"
    },
    "correta": "a"
  },
  {
    "enunciado": "Os pulmões são atravessados por duas circulações, a pulmonar, que sofre hematose e a sistêmica.  Os vasos relacionados a esta última são representados pelas:",
    "imagem": null,
    "alternativas": {
      "a": "Artérias torácicas, que são subdivisões da artéria pulmonar",
      "b": "Artérias pulmonares, que transportam sangue arterial",
      "c": "Veias pulmonares, responsáveis pela entrada de oxigênio nos pulmões",
      "d": "Artérias brônquicas, que são ramos colaterais da aorta torácica"
    },
    "correta": "d"
  },
  {
    "enunciado": "O joelho é classificado morfologicamente como uma articulação:",
    "imagem": null,
    "alternativas": {
      "a": "Bicondilar",
      "b": "Plana",
      "c": "Esferoidea",
      "d": "Trocoidea"
    },
    "correta": "a"
  },
  {
    "enunciado": "Comparando a histologia de pele grossa e pele fina, podemos afirmar que:",
    "imagem": null,
    "alternativas": {
      "a": "Na pele fina a epiderme é mais espessa em relação a pele grossa",
      "b": "A pele fina apresenta uma camada córnea mais desenvolvida",
      "c": "Na pele grossa as papilas dérmicas são pouco desenvolvidas em relação a pele fina",
      "d": "Na pele fina estão presentes numerosos pelos e glândulas sebácias"
    },
    "correta": "d"
  },
  {
    "enunciado": "A articulação do quadril realiza movimentosd nos eixos:",
    "imagem": null,
    "alternativas": {
      "a": "sagital, transversal e longitudinal",
      "b": "sagital, superior e diagonal",
      "c": "longitudinal, tranversal e latero-lateral",
      "d": "coronal, axial e sagital"
    },
    "correta": "a"
  },
  {
    "enunciado": "A flexão plantar do pé é realizada",
    "imagem": null,
    "alternativas": {
      "a": "por músculos da panturrilha, incluindo o m. tríceps sural",
      "b": "por músculos da coxa cujo tendão vai até o calcâneo",
      "c": "pelo músculo tibial anterior apenas",
      "d": "pelos músculos fibular longo e fibular curto"
    },
    "correta": "a"
  },
  {
    "enunciado": "O mediastino é o espaço delimitado pela abertura superior do tórax, pelo diafragma e pelas pleuras pulmonares.  O coração está localizado:",
    "imagem": null,
    "alternativas": {
      "a": "O mediastino não apresenta subdivisões precisas sendo a região ocupada predominantemente pelo coração e pulmões",
      "b": "Parte no mediastino superior e parte no mediastino médio",
      "c": "As estruturas vasculares estão localizadas no mediastino anterior e o coração no mediastino posterior",
      "d": "No mediastino inferior, medialmente"
    },
    "correta": "d"
  },
  {
    "enunciado": "São músculos que flexionam a coxa:",
    "imagem": null,
    "alternativas": {
      "a": "tríceps, semitendíneo, semimembranáceo, bíceps",
      "b": "semitendíneo, semimembranáceo, grácil, sartório",
      "c": "pectíneo, sartório, quadríceps, iliopsoas",
      "d": "bíceps, quadríceps, sartório, grácil"
    },
    "correta": "c"
  },
  {
    "enunciado": "Em relação as características histológicas da árvore bronquial, é correto afirmar que:",
    "imagem": null,
    "alternativas": {
      "a": "Os pneumócitos do tipo II são encontrados na parede dos bronquíolos",
      "b": "Os bronquíolos são caracterizados pela ausência de cartilagem em sua parede",
      "c": "Os anéis que cartilagem da traqueia são constituídos de cartilagem elástica",
      "d": "O brônquios não possuem cartilagem em sua parede, predominando músculo liso"
    },
    "correta": "b"
  },
  {
    "enunciado": "Sobre a absorção do folato, assinale a alternativa correta:",
    "imagem": null,
    "alternativas": {
      "a": "A vitamina B9 sempre é absorvida na forma de folato.",
      "b": "O ácido fólico é absorvido na forma conjugada com o fator intrínseco.",
      "c": "O folato é absorvido na forma de monoglutamato.",
      "d": "O ácido fólico é absorvido na presença de cálcio na forma de folato."
    },
    "correta": "c"
  },
  {
    "enunciado": "O folato, oriundo dos alimentos, é ingerido em sua forma inativa que é chamada de:",
    "imagem": null,
    "alternativas": {
      "a": "Monoglutamato de ácido fólico.",
      "b": "Metiltetrahidrofolato.",
      "c": "Tetrahidrofolato.",
      "d": "Poliglutamato de ácido fólico."
    },
    "correta": "d"
  },
  {
    "enunciado": "Selecione os alimentos que sejam fontes de ferro heme e não heme, respectivamente:",
    "imagem": null,
    "alternativas": {
      "a": "Banana e leite.",
      "b": "Maçã e peixe.",
      "c": "Ovo e cereal.",
      "d": "Amêndoa e carne bovina."
    },
    "correta": "c"
  },
  {
    "enunciado": "A dosagem de hemoglobina fica abaixo do valor de referência, indicando anemia, quando a deficiência de ferro:",
    "imagem": null,
    "alternativas": {
      "a": "Está no estágio I.",
      "b": "Está no estágio II.",
      "c": "Não se altera.",
      "d": "Está no estágio III."
    },
    "correta": "d"
  },
  {
    "enunciado": "As alterações visíveis na pele dos indivíduos idosos são provenientes do próprio processo de envelhecimento cutâneo, da constituição genética, dos fatores ambientais, entre outros.  Na figura abaixo, pele de indivíduo jovem (A) e idoso (B), pode se observar:",
    "imagem": "https://i.imgur.com/UESa8j8.png",
    "alternativas": {
      "a": "Fragmentação de fibras elásticas e perda de disposição elástica na parte superior da derme.",
      "b": "Preservação de fibras elásticas e perda de disposição elástica na parte superior da derme.",
      "c": "Fragmentação de fibras colágenas e preservação de disposição elástica na parte superior da epiderme.",
      "d": "Preservação de fibras colágenas e perda de disposição elásticas na parte superior da epiderme"
    },
    "correta": "a"
  },
  {
    "enunciado": "Dentre os sintomas característicos da osteoartrite, tem se dor profunda que piora com o uso, rigidez matinal, crepitação e limitação da amplitude de movimentos.  Em relação as características microscópicas (figura), pode se observar:",
    "imagem": null,
    "alternativas": {
      "a": "Aumento de conteúdo aquoso da matriz e diminuição de concentração de proteoglicanas, as fibras de colágeno tipo II na zona superficial são clivadas, os condrócitos morrem e porções de cartilagem em toda a sua espessura são esmagadas.",
      "b": "Aumento de conteúdo aquoso da matriz e de concentração de proteoglicanas, as fibras de colágeno tipo II na zona superficial são clivadas, os condrócitos morrem e porções de cartilagem em toda a sua espessura são esmagadas.",
      "c": "Aumento de conteúdo aquoso da matriz e diminuição de concentração de proteoglicanas, as fibras de colágeno tipo II na zona superficial são clivadas, os osteócitos morrem e porções de cartilagem em toda a sua espessura são esmagadas.",
      "d": "Aumento de conteúdo aquoso da matriz e de concentração de proteoglicanas, as fibras de colágeno tipo II na zona superficial são clivadas, os osteócitos morrem e porções de cartilagem em toda a sua espessura são esmagadas."
    },
    "correta": "a"
  },
  {
    "enunciado": "A micróglia é constituída por células fagocíticas derivadas do mesoderma que atuam como macrófagos residentes no SNC.  Elas compartilham muitos marcadores de superfície com monócitos/macrófagos periféricos.  Quando há lesão, essas células modificam a morfologia, figura abaixo, dentre essas modificações tem -se:",
    "imagem": "https://i.imgur.com/OJ0Upu6.png",
    "alternativas": {
      "a": "Perda de prolongamentos, forma arredondada, são macrófagos com capacidade fagocitária, chamadas células granulo-adiposas.",
      "b": "Aumento de prolongamentos, forma arredondada, são macrófagos com capacidade fagocitária, chamadas células granulo-adiposas.",
      "c": "Perda de prolongamentos, forma arredondada, são fibroblastos com capacidade fagocitária, chamadas células granulo-adiposas.",
      "d": "Aumento de prolongamentos, forma arredondada, são fibroblastos com capacidade fagocitária, chamadas células granulo-adiposas."
    },
    "correta": "a"
  },
  {
    "enunciado": "O sintoma cardinal da bronquite crônica é a tosse persistente com produção de escarro esparso.  Durante muitos anos, nenhum outro prejuízo funcional respiratório está presente, mas, finalmente, surge dispneia aos esforços.  Dentre os aspectos macroscópicos dessa patologia, pode-se observar:",
    "imagem": "https://i.imgur.com/qxbeuya.png",
    "alternativas": {
      "a": "Hiperemia, tumefação e edema das membranas mucosas, frequentemente acompanhadas pelo excesso de secreções mucinosas ou mucopurulentas.",
      "b": "Atrofia das membranas mucosas, frequentemente acompanhadas pelo excesso de secreções mucinosas ou mucopurulentas",
      "c": "Hiperemia, tumefação e edema das membranas mucosas, frequentemente acompanhadas pela diminuição de secreções mucinosas ou mucopurulentas",
      "d": "Atrofia das membranas mucosas, frequentemente acompanhadas pela diminuição de secreções mucinosas ou mucopurulentas"
    },
    "correta": "a"
  },
  {
    "enunciado": "A DPOC constitui um problema de saúde pública importante.  Há uma clara associação entre o tabagismo pesado e o enfisema, e as mulheres e afro-americanos são mais suscetíveis que outros grupos.  Aproximadamente 35%-50% de fumantes pesados desenvolvem DPOC; de maneira inversa, 80% da DPOC se desenvolve por causa do tabagismo.  A figura abaixo, mostra a macroscopia e microscopia do pulmão com enfisema pulmonar, dentre os fatores que levam a essa patologia, tem-se:",
    "imagem": "https://i.imgur.com/XJBTkmO.png",
    "alternativas": {
      "a": "Estresse oxidativo, aumento de apoptose, senescência, liberação de mediadores inflamatórios e desequilíbrio de proteases levando a destruição da parede alveolar.",
      "b": "Estresse oxidativo, hipersercreção de muco, liberação de mediadores inflamatórios e desequilíbrio de proteases levando a destruição da parede alveolar",
      "c": "Estresse oxidativo, inflamação, liberação de mediadores inflamatórios e desequilíbrio de proteases levando a destruição da parede alveolar.",
      "d": "Estresse oxidativo, infecção, liberação de mediadores inflamatórios e desequilíbrio de proteases levando a destruição da parede alveolar"
    },
    "correta": "a"
  },
  {
    "enunciado": "Na esclerose média de Mönckeberg, indivíduos com mais de 50 anos são mais comumente afetados.  A figura abaixo pode-se observar as alaterações acometidas por essa considerações. Dentre as características observadas, tem-se:",
    "imagem": "https://i.imgur.com/NpHkjMS.png",
    "alternativas": {
      "a": "Calcificação das paredes das artérias musculares, que envolvem tipicamente a membrana elástica interna, e não são clinicamente significativas.",
      "b": "Calcificação das paredes das arteríolas, que envolvem tipicamente a membrana elástica interna, e não são clinicamente significativas.",
      "c": "Calcificação das paredes das artérias musculares, que envolvem tipicamente a membrana elástica interna, e são clinicamente significativas.",
      "d": "Calcificação das paredes das arteriolas, que envolvem tipicamente a membrana elástica interna e são clinicamente significativas."
    },
    "correta": "a"
  },
  {
    "enunciado": "A população de idosos nos próximos anos, pode chegar a mais de 30 milhões no Brasil.  O envelhecimento é um processo natural, no qual o organismo sofre alterações fisiológicas.  Sendo assim, sobre a lipofucsina, figura, assinale a alternativa correta:",
    "imagem": null,
    "alternativas": {
      "a": "É um pigmento intracelular, marcador do envelhecimento, endógeno, de cor amarelo- acastanhado",
      "b": "É um pigmento intracelular, marcador do envelhecimento, exógeno, de cor amarelo- acastanhado",
      "c": "É um pigmento extracelular, marcador do envelhecimento, endógeno, de cor amarelo- acastanhado",
      "d": "É um pigmento extracelular, marcador do envelhecimento, exógeno, de cor amarelo- acastanhado"
    },
    "correta": "a"
  },
  {
    "enunciado": "A lesão neuronal comumente resulta em morte celular por apoptose ou necrose.  A perda de neurônios, que é difícil de detectar sem quantificação formal, pode contribuir ainda para a disfunção.  Assim, hipóxia, necrose podem modificar a morfologia de células, como os astrócitos, desta forma, assinale a alternativa que caracterize a microscopia observada na figura abaixo:",
    "imagem": "https://i.imgur.com/CkWzhBK.png",
    "alternativas": {
      "a": "Os núcleos dos astrócitos aumentam de tamanho e se tornam vesiculares, desenvolvendo nucléolos proeminentes, o citoplasma anteriormente escasso se expande, essas células são chamadas de astrócitos gemistocíticos.",
      "b": "Os núcleos dos astrócitos diminuem de tamanho e se tornam vesiculares, desenvolvendo nucléolos proeminentes, o citoplasma anteriormente escasso se expande, essas células são chamadas de astrócitos gemistocíticos.",
      "c": "Os núcleos dos astrócitos aumentam de tamanho e se tornam vesiculares, desenvolvendo nucléolos proeminentes, o citoplasma fica escasso, essas células são chamadas de astrócitos gemistocíticos.",
      "d": "Os núcleos dos astrócitos diminuem de tamanho e se tornam vesiculares, desenvolvendo nucléolos proeminentes, o citoplasma fica escasso, essas células são chamadas de astrócitos gemistocíticos."
    },
    "correta": "a"
  },
  {
    "enunciado": "A aterosclerose é a base da patogenia das doenças vasculares periféricas, cerebral e coronariana, causando mais morbidade e mortalidade (aproximadamente metade dos óbitos) no mundo ocidental que qualquer outra doença.  A probabilidade de desenvolver a aterosclerose é determinada pela combinação de fatores de riscos adquiridos e hereditários.  A figura abaixo mostra a microscopia de uma artéria com aterosclerose, assinale a alternativa que caracterize a composição da letra C, na lâmina:",
    "imagem": "https://i.imgur.com/tbxAIBF.png",
    "alternativas": {
      "a": "C: centro necrótico: dedritos celulares, cristais de colesterol, células espumosas e cálcio.",
      "b": "C: centro necrótico: células musculares lisas, cristais de colesterol e células espumosas.",
      "c": "C: centro necrótico: linfócitos, macrófagos, cristais de colesterol e células espumosas.",
      "d": "C: centro necrótico: macrófagos, cristais de colesterol e células espumosas."
    },
    "correta": "a"
  },
  {
    "enunciado": "Influências ambientais e genéticas contribuem para a patogenia da Osteoartrite (OA), a associação com o envelhecimento é forte;  a prevalência da OA aumenta exponencialmente após os 50 anos, e cerca de 40% das pessoas com idade superior a 70 anos são afetadas.  A figura abaixo mostra o aspecto macroscópico dessa patologia. Assinale a alternativa que corresponda aos números 1, 2 e 3",
    "imagem": "https://i.imgur.com/SY30Vwt.png",
    "alternativas": {
      "a": "(1) Superfície articular degenerada expondo osso subcondral, (2) cisto subcondral e (3) cartilagem articular residual.",
      "b": "(1) Superfície articular degenerada expondo osso subcondral, (2) cartilagem articular residual e (3) cisto subcondral",
      "c": "(1) Cartilagem articular residual, (2) cisto subcondral e (3) Superfície articular degenerada expondo osso subcondral.",
      "d": "(1) Cartilagem articular residual, (2) Superfície articular degenerada expondo osso subcondral e (3) cisto subcondral"
    },
    "correta": "a"
  },
  {
    "enunciado": "As células da mucosa gástrica são essenciais para o processo de digestão e absorção de diversos nutrientes.  Levando em consideração os micronutrientes estudados nesse módulo é correto afirmar que:",
    "imagem": null,
    "alternativas": {
      "a": "As células principais produzem transcobalamina, essencial para o transporte da cianocobalamina após sua absorção.",
      "b": "As células principais produzem o fator intrínseco, essencial para a absorção da cianocobalamina no ileo.",
      "c": "As células parietais produzem transcobalamina, essencial para o transporte da cianocobalamina após sua absorção.",
      "d": "As células parietais produzem o fator intrínseco, essencial para a absorção da cianocobalamina no ileo."
    },
    "correta": "d"
  },
  {
    "enunciado": "A metionina é um aminoácido essencial que está envolvido na síntese do DNA e seu processo metabólico se relaciona com as vitaminas B9 e B12.  Portanto, a vitamina B12 participa como cofator da enzima que converte:",
    "imagem": null,
    "alternativas": {
      "a": "uridina em metionina.",
      "b": "uridina em timina.",
      "c": "homocisteína em metionina.",
      "d": "homocisteína em timina."
    },
    "correta": "c"
  },
{
    "enunciado": "Quanto a morfologia dos neutrófilos, é possível afirmar que:",
    "imagem": null,
    "alternativas": {
      "a": "Núcleo com três a cinco lóbulos e excêntrico, cromatina grosseira e homogênea, nucléolos ausentes. Citoplasma eosinofílico, com granulações numerosas e moderadamente grosseiras.",
      "b": "Núcleo bilobulado, excêntrico, cromatina grosseira e homogênea, nucléolos ausentes. Citoplasma eosinofílico, com granulações numerosa e moderadamente grosseiras.",
      "c": "Núcleo bilobulado de forma bizarra e excêntrico, de difícil visibilização, cromatina grosseira e homogênea, nucléolos ausentes. Citoplasma com coloração escura devido a presença de muitas granulações basófilas grosseiras.",
      "d": "Possui núcleo com três a cinco lóbulos e excêntrico, cromatina grosseira e homogênea, nucléolos ausentes. Citoplasma acidófilo, com granulações delicadas presentes em alta quantidade."
    },
    "correta": "d"
  },
  {
    "enunciado": "Levando em consideração a formação dos neutrófilos na medula óssea e a maturação de seus precursores, qual das situações abaixo pode caracterizar desvio à esquerda não escalonado?",
    "imagem": null,
    "alternativas": {
      "a": "Presença de neutrófilos em maior quantidade que bastonetes.",
      "b": "Presença de bastonetes em maior quantidade que metamielócitos.",
      "c": "Presença de mielócitos em maior quantidade que metamielócitos.",
      "d": "Presença de metamielócitos em maior quantidade que mielócitos."
    },
    "correta": "c"
  },
  {
    "enunciado": "O leucócito indicado pela seta na imagem, pode ser encontrado no sangue acima do seu valor de referência no caso de:",
    "imagem": null,
    "alternativas": {
      "a": "Infecção bacteriana.",
      "b": "Infecção viral.",
      "c": "Inflamação aguda.",
      "d": "Processos alérgicos."
    },
    "correta": "b"
  },
  {
    "enunciado": "Qual o nome do leucócito que quando visto na microscopia óptica, não é possível observar seu núcleo por estar coberto por grânulos citoplasmáticos pretos?",
    "imagem": null,
    "alternativas": {
      "a": "Eosinófilo.",
      "b": "Basófilo.",
      "c": "Neutrófilo.",
      "d": "Monócito."
    },
    "correta": "b"
  },
  {
    "enunciado": "Infecção é definida como a penetração, alojamento e multiplicação do agente infeccioso no hospedeiro, determinando a ocorrência de reação a si próprio ou a seus produtos tóxicos, no local onde se encontram ou a distância.  Em reações inflamatórias bacterianas agudas qual característica é mais provável de ser evidenciada no leucograma?",
    "imagem": null,
    "alternativas": {
      "a": "Monocitose.",
      "b": "Linfocitose.",
      "c": "Leucopenia.",
      "d": "Neutrofilia."
    },
    "correta": "d"
  },
  {
    "enunciado": "Podemos dividir os leucócitos em dois grandes grupos: os granulócitos e os agranulócitos.  O primeiro grupo apresenta grânulos no citoplasma e núcleo com formato irregular.  Já os agranulócitos não possuem grânulos e apresentam núcleo com formato relativamente regular.  A sequência de diferenciação dos granulócitos neutrófilos será:",
    "imagem": null,
    "alternativas": {
      "a": "Pró-mielócito, metamielócito, mielócito, bastonete e neutrófilo.",
      "b": "Pró-mielócito, bastonete, metamielócito, mielócito e neutrófilo.",
      "c": "Pró-mielócito, mielócito, metamielócito, bastonete e neutrófilo.",
      "d": "Pró-mielócito, bastonete, mielócito, metamielócito e neutrófilo."
    },
    "correta": "c"
  },
  {
    "enunciado": "Qual leucócito pode estar acima do valor de referência em doenças inflamatórias crônicas?",
    "imagem": null,
    "alternativas": {
      "a": "Eosinófilo.",
      "b": "Linfócito.",
      "c": "Monócito.",
      "d": "Basófilo."
    },
    "correta": "c"
  },
  {
    "enunciado": "A alteração indicada pelas setas pretas na imagem, se refere a:",
    "imagem": null,
    "alternativas": {
      "a": "Anisocitose, que é indicada através do VCM.",
      "b": "Poiquilocitose, que é indicada apenas através do RDW.",
      "c": "Poiquilocitose, que é observada na microscopia.",
      "d": "Anisocitose, que é indicada através do RDW."
    },
    "correta": "c"
  },
  {
    "enunciado": "A alteração indicada pelas setas azuis e pretas na imagem, se refere a:",
    "imagem": null,
    "alternativas": {
      "a": "Poiquilocitose, que é indicada apenas através do RDW.",
      "b": "Anisocitose, que é indicada através do RDW.",
      "c": "Anisocitose, que é indicada através do VCM.",
      "d": "Poiquilocitose, que é observada na microscopia."
    },
    "correta": "b"
  },
  {
    "enunciado": "A síntese adequada de hemoglobina depende de que a célula receba a quantidade de ferro adequada, da produção intracelular da porfirina e da produção de cadeias globínicas.  Sendo assim, qual dos precursores eritrocíticos apresenta maior síntese de hemoglobina ?",
    "imagem": null,
    "alternativas": {
      "a": "Reticulócito.",
      "b": "Eritroblasto ortocromático.",
      "c": "Eritroblasto policromático.",
      "d": "Eritroblasto basófilo."
    },
    "correta": "b"
  },
  {
    "enunciado": "A célula tronco pluripotente é responsável por originar as células do sangue.  Quanto às divisões mitóticas que essa célula realiza, é correto afirmar que:",
    "imagem": null,
    "alternativas": {
      "a": "Divisão simétrica se refere apenas a formação de duas células tronco pluripotentes filhas, com o objetivo de auto-renovação.",
      "b": "Divisão simétrica se refere apenas a formação de duas células tronco destinadas a diferenciação, ou seja, formação das células sanguíneas.",
      "c": "Divisão simétrica se refere tanto a auto-renovação quanto a formação de células filhas que irão se diferenciar nas células do sangue.",
      "d": "Divisão assimétrica não ocorre nas células tronco pluripotentes encontradas na medula óssea."
    },
    "correta": "c"
  },
  {
    "enunciado": "Em uma anemia carencial por deficiência grave de ferro a observação esperada em uma extensão sanguínea será:",
    "imagem": null,
    "alternativas": {
      "a": "Macrocitose devido ao aumento do CHCM, hipocromia devido ao diminuição de HCM, ausência de anisocitose (RDW aumentado) e hematócrito acima do normal.",
      "b": "Microcitose devido a diminuição de CHCM, hipocromia devido a diminuição de HCM, ausência de anisocitose (RDW diminuído) e hematócrito abaixo do normal.",
      "c": "Macrocitose devido ao aumento do VCM, hipocromia devido a diminuição de CHCM, presença de anisocitose (RDW aumentado) e hematócrito acima do normal.",
      "d": "Microcitose devido a diminuição de VCM, hipocromia devido a diminuição de CHCM, presença de anisocitose (RDW aumentado) e hematócrito abaixo do normal."
    },
    "correta": "d"
  },
  {
    "enunciado": "Com relação aos achados no hemograma durante a anemia megaloblástica, analise as afirmativas a seguir:\nI- O HCM estará aumentado porque a quantidade de hemoglobina (peso) é proporcional ao tamanho celular e a quantidade reduzida de eritrócitos no sangue periférico do paciente.\nII- Presença de eritroblastos no sangue periférico (observação incluída no laudo laboratorial).\nIII- CHCM estará diminuído devido à redução de eritrócitos circulantes no sangue periférico.\nAssinale a alternativa que contenha as afirmativas corretas:",
    "imagem": null,
    "alternativas": {
      "a": "Somente as afirmativas I e II estão corretas.",
      "b": "Somente as afirmativas I e III estão corretas.",
      "c": "Somente a afirmativa III está correta.",
      "d": "Somente as afirmativas II e III estão corretas."
    },
    "correta": "a"
  },
  {
    "enunciado": "A hematologia estuda, principalmente, os elementos figurados do sangue: hemáceas, leucócitos e plaquetas.  Estuda a produção e o estado de normalidade dos elementos do sangue. Para isso alguns termos são utilizados.  Assinale a alternativa que apresenta o conceito correto para o termo:",
    "imagem": null,
    "alternativas": {
      "a": "Poiquilocitose é uma alteração na cor da hemácia (glóbulos vermelhos do sangue ou eritrocitos).",
      "b": "Microcitose é o termo utilizado para referir-se ao tamanho aumentado da hemácia por falta de vitamina B 12.",
      "c": "Hipocromia é o termo usado na hematologia para referir-se ao aumento da coloração dos eritrócitos ou hemácias.",
      "d": "Anisocitose é um termo da hematologia que significa disparidade do tamanho, principalmente nas hemácias."
    },
    "correta": "d"
  },
  {
    "enunciado": "O sintoma cardinal da bronquite crônica é a tosse persistente com produção de escarro esparso.  Durante muitos anos, nenhum outro prejuízo funcional respiratório está presente, mas, finalmente, surge dispneia aos esforços.  Dentre os aspectos macroscópicos dessa patologia, pode-se observar:",
    "imagem": null,
    "alternativas": {
      "a": "Hiperemia, tumefação e edema das membranas mucosas, frequentemente acompanhadas pelo excesso de secreções mucinosas ou mucopurulentas.",
      "b": "Atrofia das membranas mucosas, frequentemente acompanhadas pelo excesso de secreções mucinosas ou mucopurulentas",
      "c": "Hiperemia, tumefação e edema das membranas mucosas, frequentemente acompanhadas pela diminuição de secreções mucinosas ou mucopurulentas",
      "d": "Atrofia das membranas mucosas, frequentemente acompanhadas pela diminuição de secreções mucinosas ou mucopurulentas"
    },
    "correta": "a"
  },
  {
    "enunciado": "Influências ambientais e genéticas contribuem para a patogenia da Osteoartrite (OA), a associação com o envelhecimento é forte; a prevalência da OA aumenta exponencialmente após os 50 anos, e cerca de 40% das pessoas com idade superior a 70 anos são afetadas.  A figura abaixo mostra o aspecto macroscópico dessa patologia. Assinale a alternativa que corresponda aos números 1, 2 e 3",
    "imagem": null,
    "alternativas": {
      "a": "(1) Superfície articular degenerada expondo osso subcondral, (2) cisto subcondral e (3) cartilagem articular residual.",
      "b": "(1) Superfície articular degenerada expondo osso subcondral, (2) cartilagem articular residual e (3) cisto subcondral",
      "c": "(1) Cartilagem articular residual, (2) cisto subcondral e (3) Superfície articular degenerada expondo osso subcondral.",
      "d": "(1) Cartilagem articular residual, (2) Superfície articular degenerada expondo osso subcondral e (3) cisto subcondral"
    },
    "correta": "a"
  },
  {
    "enunciado": "Dentre os sintomas característicos da osteoartrite, tem se dor profunda que piora com o uso, rigidez matinal, crepitação e limitação da amplitude de movimentos.  Em relação as características microscópicas (figura), pode se observar:",
    "imagem": null,
    "alternativas": {
      "a": "Aumento de conteúdo aquoso da matriz e diminuição de concentração de proteoglicanas, as fibras de colágeno tipo II na zona superficial são clivadas, os condrócitos morrem e porções de cartilagem em toda a sua espessura são esmagadas.",
      "b": "Aumento de conteúdo aquoso da matriz e de concentração de proteoglicanas, as fibras de colágeno tipo II na zona superficial são clivadas, os condrócitos morrem e porções de cartilagem em toda a sua espessura são esmagadas.",
      "c": "Aumento de conteúdo aquoso da matriz e diminuição de concentração de proteoglicanas, as fibras de colágeno tipo II na zona superficial são clivadas, os osteócitos morrem e porções de cartilagem em toda a sua espessura são esmagadas.",
      "d": "Aumento de conteúdo aquoso da matriz e de concentração de proteoglicanas, as fibras de colágeno tipo II na zona superficial são clivadas, os osteócitos morrem e porções de cartilagem em toda a sua espessura são esmagadas."
    },
    "correta": "a"
  },
  {
    "enunciado": "A população de idosos nos próximos anos, pode chegar a mais de 30 milhões no Brasil.  O envelhecimento é um processo natural, no qual o organismo sofre alterações fisiológicas.  Sendo assim, sobre a lipofucsina, figura, assinale a alternativa correta:",
    "imagem": null,
    "alternativas": {
      "a": "É um pigmento intracelular, marcador do envelhecimento, endógeno, de cor amarelo- acastanhado",
      "b": "É um pigmento intracelular, marcador do envelhecimento, exógeno, de cor amarelo- acastanhado",
      "c": "É um pigmento extracelular, marcador do envelhecimento, endógeno, de cor amarelo- acastanhado",
      "d": "É um pigmento extracelular, marcador do envelhecimento, exógeno, de cor amarelo- acastanhado"
    },
    "correta": "a"
  },
  {
    "enunciado": "As alterações visíveis na pele dos indivíduos idosos são provenientes do próprio processo de envelhecimento cutâneo, da constituição genética, dos fatores ambientais, entre outros.  Na figura abaixo, pele de indivíduo jovem (A) e idoso (B), pode se observar:",
    "imagem": null,
    "alternativas": {
      "a": "Fragmentação de fibras elásticas e perda de disposição elástica na parte superior da derme.",
      "b": "Preservação de fibras elásticas e perda de disposição elástica na parte superior da derme.",
      "c": "Fragmentação de fibras colágenas e preservação de disposição elástica na parte superior da epiderme.",
      "d": "Preservação de fibras colágenas e perda de disposição elásticas na parte superior da epiderme"
    },
    "correta": "a"
  },
  {
    "enunciado": "A micróglia é constituída por células fagocíticas derivadas do mesoderma que atuam como macrófagos residentes no SNC.  Elas compartilham muitos marcadores de superfície com monócitos/macrófagos periféricos. Quando há lesão, essas células modificam a morfologia, figura abaixo, dentre essas modificações tem -se:",
    "imagem": null,
    "alternativas": {
      "a": "Perda de prolongamentos, forma arredondada, são macrófagos com capacidade fagocitária, chamadas células granulo-adiposas.",
      "b": "Aumento de prolongamentos, forma arredondada, são macrófagos com capacidade fagocitária, chamadas células granulo-adiposas.",
      "c": "Perda de prolongamentos, forma arredondada, são fibroblastos com capacidade fagocitária, chamadas células granulo-adiposas.",
      "d": "Aumento de prolongamentos, forma arredondada, são fibroblastos com capacidade fagocitária, chamadas células granulo-adiposas."
    },
    "correta": "a"
  },
  {
    "enunciado": "A aterosclerose é a base da patogenia das doenças vasculares periféricas, cerebral e coronariana, causando mais morbidade e mortalidade (aproximadamente metade dos óbitos) no mundo ocidental que qualquer outra doença.  A probabilidade de desenvolver a aterosclerose é determinada pela combinação de fatores de riscos adquiridos e hereditários.  A figura abaixo mostra a microscopia de uma artéria com aterosclerose, assinale a alternativa que caracterize a composição da letra C, na lâmina:",
    "imagem": "https://i.imgur.com/cFsGUly.png",
    "alternativas": {
      "a": "C: centro necrótico: dedritos celulares, cristais de colesterol, células espumosas e cálcio.",
      "b": "C: centro necrótico: células musculares lisas, cristais de colesterol e células espumosas.",
      "c": "C: centro necrótico: linfócitos, macrófagos, cristais de colesterol e células espumosas.",
      "d": "C: centro necrótico: macrófagos, cristais de colesterol e células espumosas."
    },
    "correta": "a"
  },
  {
    "enunciado": "O exame laboratorial que representa a porcentagem de todos os sítios da transferrina que estão ocupados pelo ferro é a dosagem:",
    "imagem": null,
    "alternativas": {
      "a": "da saturação da transferrina.",
      "b": "da capacidade total de ligação do ferro.",
      "c": "do ferro sérico.",
      "d": "da transferrina."
    },
    "correta": "a"
  },
  {
    "enunciado": "A dosagem de hemoglobina fica abaixo do valor de referência, indicando anemia, quando a deficiência de ferro:",
    "imagem": null,
    "alternativas": {
      "a": "Não se altera.",
      "b": "Está no estágio I.",
      "c": "Está no estágio III.",
      "d": "Está no estágio II."
    },
    "correta": "c"
  },
  {
    "enunciado": "Sobre a absorção do folato, assinale a alternativa correta:",
    "imagem": null,
    "alternativas": {
      "a": "O ácido fólico é absorvido na forma conjugada com o fator intrínseco.",
      "b": "O ácido fólico é absorvido na presença de cálcio na forma de folato.",
      "c": "A vitamina B9 sempre é absorvida na forma de folato.",
      "d": "O folato é absorvido na forma de monoglutamato."
    },
    "correta": "d"
  },
  {
    "enunciado": "Uma mulher de 52 anos de idade apresenta cansaço há vários meses.  Exames de sangue revelam uma anemia macrocítica, níveis reduzidos de hemoglobina, níveis elevados de homocisteína e níveis normais de ácido metil-malônico.  Qual dos seguintes compostos é o mais provável de estar deficiente nesta paciente?",
    "imagem": null,
    "alternativas": {
      "a": "Ferro.",
      "b": "Ácido fólico e vitamina B12.",
      "c": "Vitamina C.",
      "d": "Ácido fólico."
    },
    "correta": "d"
  },
  {
    "enunciado": "Assinale a alternativa que identifique a forma em que a cobalamina se encontra para atuar como cofator da enzima metionina sintase.",
    "imagem": null,
    "alternativas": {
      "a": "Etilcobalamina.",
      "b": "Metacobalamina.",
      "c": "Metilcobalamina.",
      "d": "Metionilcobalamina."
    },
    "correta": "c"
  },
  {
    "enunciado": "A metionina é um aminoácido essencial que está envolvido na síntese do DNA e seu processo metabólico se relaciona com as vitaminas B9 e B12.  Portanto, a vitamina B12 participa como cofator da enzima que converte:",
    "imagem": null,
    "alternativas": {
      "a": "uridina em metionina.",
      "b": "homocisteína em metionina.",
      "c": "uridina em timina.",
      "d": "homocisteína em timina."
    },
    "correta": "b"
  },
  {
    "enunciado": "Quando um indivíduo é acometido por osteoporose as vértebras são frequentemente atingidas.  São características que permitem identificar a vértebra lombar:",
    "imagem": null,
    "alternativas": {
      "a": "O processo espinhosos paralelo ao plano horizontal",
      "b": "O corpo de igual volume ao segmento cervical",
      "c": "O processo transverso com fossa articular para receber as costelas",
      "d": "O processo espinhoso obtuso em relação ao processo transverso"
    },
    "correta": "a"
  },
  {
    "enunciado": "A articulação do quadril realiza movimentosd nos eixos:",
    "imagem": null,
    "alternativas": {
      "a": "longitudinal, tranversal e latero-lateral",
      "b": "sagital, transversal e longitudinal",
      "c": "coronal, axial e sagital",
      "d": "sagital, superior e diagonal"
    },
    "correta": "b"
  },
  {
    "enunciado": "O joelho é classificado morfologicamente como uma articulação:",
    "imagem": null,
    "alternativas": {
      "a": "Esferoidea",
      "b": "Trocoidea",
      "c": "Bicondilar",
      "d": "Plana"
    },
    "correta": "c"
  },
  {
    "enunciado": "Em relação as características histológicas da árvore bronquial, é correto afirmar que:",
    "imagem": null,
    "alternativas": {
      "a": "Os bronquíolos são caracterizados pela ausência de cartilagem em sua parede",
      "b": "O brônquios não possuem cartilagem em sua parede, predominando músculo liso",
      "c": "Os pneumócitos do tipo II são encontrados na parede dos bronquíolos",
      "d": "Os anéis que cartilagem da traqueia são constituídos de cartilagem elástica"
    },
    "correta": "a"
  },
  {
    "enunciado": "São músculos que flexionam a coxa:",
    "imagem": null,
    "alternativas": {
      "a": "semitendíneo, semimembranáceo, grácil, sartório",
      "b": "bíceps, quadríceps, sartório, grácil",
      "c": "triceps, semitendíneo, semimembranáceo, bíceps",
      "d": "pectíneo, sartório, quadríceps, iliopsoas"
    },
    "correta": "d"
  },
  {
    "enunciado": "Comparando a histologia de pele grossa e pele fina, podemos afirmar que:",
    "imagem": null,
    "alternativas": {
      "a": "Na pele fina estão presentes numerosos pelos e glândulas sebácias",
      "b": "Na pele fina a epiderme é mais espessa em relação a pele grossa",
      "c": "Na pele grossa as papilas dérmicas são pouco desenvolvidas em relação a pele fina",
      "d": "A pele fina apresenta uma camada córnea mais desenvolvida"
    },
    "correta": "a"
  },
  {
    "enunciado": "A flexão plantar do pé é realizada",
    "imagem": null,
    "alternativas": {
      "a": "por músculos da panturrilha, incluindo o m. tríceps sural",
      "b": "pelo músculo tibial anterior apenas",
      "c": "por músculos da coxa cujo tendão vai até o calcâneo",
      "d": "pelos músculos fibular longo e fibular curto"
    },
    "correta": "a"
  },
  {
    "enunciado": "Sobre as artérias coronária direita e interventricular anterior podemos afirmar:",
    "imagem": null,
    "alternativas": {
      "a": "São oriundas das aa.aorta e coronária esquerda respectivamente",
      "b": "Tratam-se de vasos que não sofrem anastomoses, nos dois casos",
      "c": "Não são ramos sujeitos a formação de placa de ateroma",
      "d": "Possuem derivações denominadas diagonais em ambos os casos"
    },
    "correta": "a"
  },
  {
    "enunciado": "Os pulmões são atravessados por duas circulações, a pulmonar, que sofre hematose e a sistêmica.  Os vasos relacionados a esta última são representados pelas:",
    "imagem": null,
    "alternativas": {
      "a": "Artérias pulmonares, que transportam sangue arterial",
      "b": "Artérias brônquicas, que são ramos colaterais da aorta torácica",
      "c": "Artérias torácicas, que são subdivisões da artéria pulmonar",
      "d": "Veias pulmonares, responsáveis pela entrada de oxigênio nos pulmões"
    },
    "correta": "b"
  },
  {
    "enunciado": "O mediastino é o espaço delimitado pela abertura superior do tórax, pelo diafragma e pelas pleuras pulmonares.  O coração está localizado:",
    "imagem": null,
    "alternativas": {
      "a": "As estruturas vasculares estão localizadas no mediastino anterior e o coração no mediastino posterior",
      "b": "No mediastino inferior, medialmente",
      "c": "O mediastino não apresenta subdivisões precisas sendo a região ocupada predominantemente pelo coração e pulmões",
      "d": "Parte no mediastino superior e parte no mediastino médio"
    },
    "correta": "b"
  },
{
    "enunciado": "Na esclerose média de Mönckeberg, individuos com mais de 50 anos são mais comumente afetados. A figura abaixo pode-se observar as alaterações acometidas por essa considerações. Dentre as características observadas, tem-se:",
    "imagem": "https://i.imgur.com/rNxwhL8.png",
    "alternativas": {
      "a": "Calcificação das paredes das artérias musculares, que envolvem tipicamente a membrana elástica interna, e não são clinicamente significativas.",
      "b": "Calcificação das paredes das arteríolas, que envolvem tipicamente a membrana elástica interna, e não são clinicamente significativas.",
      "c": "Calcificação das paredes das artérias musculares, que envolvem tipicamente a membrana elástica interna, e são clinicamente significativas.",
      "d": "Calcificação das paredes das arteríolas, que envolvem tipicamente a membrana elástica interna e são clinicamente significativas."
    },
    "correta": "a"
  },
  {
    "enunciado": "A micróglia é constituída por células fagocíticas derivadas do mesoderma que atuam como macrófagos residentes no SNC. Elas compartilham muitos marcadores de superficie com monocitos/macrófagos periféricos. Quando há lesão, essas células modificam a morfologia, figura abaixo, dentre essas modificações tem-se:",
    "imagem": "https://i.imgur.com/KKVOjL0.png",
    "alternativas": {
      "a": "Perda de prolongamentos, forma arredondada, são macrófagos com capacidade fagocitária, chamadas células granulo-adiposas.",
      "b": "Aumento de prolongamentos, forma arredondada, são macrófagos com capacidade fagocitária, chamadas células granulo-adiposas.",
      "c": "Perda de prolongamentos, forma arredondada, são fibroblastos com capacidade fagocitária, chamadas células granulo-adiposas.",
      "d": "Aumento de prolongamentos, forma arredondada, são fibroblastos com capacidade fagocitária, chamadas células granulo-adiposas."
    },
    "correta": "a"
  },
  {
    "enunciado": "A aterosclerose é a base da patogenia das doenças vasculares periféricas, cerebral e coronariana, causando mais morbidade e mortalidade (aproximadamente metade dos óbitos) no mundo ocidental que qualquer outra doença. A probabilidade de desenvolver a aterosclerose é determinada pela combinação de fatores de riscos adquiridos e hereditários. A figura abaixo mostra a microscopia de uma artéria com aterosclerose. assinale a alternativa que caracterize a composição da letra C, na lâmina:",
    "imagem": "https://i.imgur.com/JQupxbP.png",
    "alternativas": {
      "a": "C: centro necrótico: dedritos celulares, cristais de colesterol, células espumosas e cálcio.",
      "b": "C: centro necrótico: células musculares lisas, cristais de colesterol e células espumosas.",
      "c": "C centro necrótico: linfocitos, macrófagos, cristais de colesterol e células espumosas.",
      "d": "C: centro necrótico: macrófagos, cristais de colesterol e células espumosas."
    },
    "correta": "a"
  },
  {
    "enunciado": "A lesão neuronal comumente resulta em morte celular por apoptose ou necrose. A perda de neurônios, que é difícil de detectar sem quantificação formal, pode contribuir ainda para a disfunção. Assim, hipóxia, necrose podem modificar a morfologia de células, como os astrócitos, desta forma, assinale a alternativa que caracterize a microscopia observada na figura abaixo:",
    "imagem": "https://i.imgur.com/72DbBIV.png",
    "alternativas": {
      "a": "Os núcleos dos astrocitos aumentam de tamanho e se tornam vesiculares, desenvolvendo nucléolos proeminentes, o citoplasma anteriormente escasso se expande, essas células são chamadas de astrócitos gemistociticos.",
      "b": "Os núcleos dos astrócitos diminuem de tamanho e se tornam vesiculares, desenvolvendo nucléolos proeminentes, o citoplasma anteriormente escasso se expande, essas células são chamadas de astrocitos gemistociticos.",
      "c": "Os núcleos dos astrócitos aumentam de tamanho e se tornam vesiculares, desenvolvendo nucléolos proeminentes, o citoplasma fica escasso, essas células são chamadas de astrócitos gemistocíticos.",
      "d": "Os núcleos dos astrócitos diminuem de tamanho e se tornam vesiculares, desenvolvendo nucléolos proeminentes, o citoplasma fica escasso, essas células são chamadas de astrócitos gemistociticos."
    },
    "correta": "a"
  },
  {
    "enunciado": "As alterações visíveis na pele dos individuos idosos são provenientes do próprio processo de envelhecimento cutâneo, da constituição genética, dos fatores ambientais, entre outros. Na figura abaixo, pele de individuo jovem (A) e idoso (B), pode se observar:",
    "imagem": "https://i.imgur.com/JbYlXZv.png",
    "alternativas": {
      "a": "Fragmentação de fibras elásticas e perda de disposição elástica na parte superior da derme.",
      "b": "Preservação de fibras elásticas e perda de disposição elástica na parte superior da derme.",
      "c": "Fragmentação de fibras colágenas e preservação de disposição elástica na parte superior da epiderme.",
      "d": "Preservação de fibras colágenas e perda de disposição elásticas na parte superior da epiderme"
    },
    "correta": "a"
  },
  {
    "enunciado": "O sintoma cardinal da bronquite crônica é a tosse persistente com produção de escarro esparso. Durante muitos anos, nenhum outro prejuízo funcional respiratório está presente, mas, finalmente, surge dispneia aos esforços. Dentre os aspectos macroscópicos dessa patologia, pode-se observar:",
    "imagem": "https://i.imgur.com/5GaCYMg.png",
    "alternativas": {
      "a": "Hiperemia, tumefação e edema das membranas mucosas, frequentemente acompanhadas pelo excesso de secreções mucinosas ou mucopurulentas.",
      "b": "Atrofia das membranas mucosas, frequentemente acompanhadas pelo excesso de secreções mucinosas ou mucopurulentas",
      "c": "Hiperemia, tumefação e edema das membranas mucosas, frequentemente acompanhadas pela diminuição de secreções mucinosas ou mucopurulentas",
      "d": "Atrofia das membranas mucosas, frequentemente acompanhadas pela diminuição de secreções mucinosas ou mucopurulentas"
    },
    "correta": "a"
  },
  {
    "enunciado": "A DPOC constitui um problema de saúde pública importante. Há uma clara associação entre o tabagismo pesado e o enfisema, e as mulheres e afro-americanos são mais suscetíveis que outros grupos. Aproximadamente 35%-50% de fumantes pesados desenvolvem DPOC; de maneira inversa, 80% da DPOC se desenvolve por causa do tabagismo. A figura abaixo, mostra a macroscopia e microscopia do pulmão com enfisema pulmonar, dentre os fatores que levam a essa patologia, tem-se:",
    "imagem": "https://i.imgur.com/DdoMWQY.png",
    "alternativas": {
      "a": "Estresse oxidativo, aumento de apoptose, senescência, liberação de mediadores inflamatórios e desequilibrio de proteases levando a destruição da parede alveolar.",
      "b": "Estresse oxidativo, hipersercreção de muco, liberação de mediadores inflamatórios e desequilibrio de proteases levando a destruição da parede alveolar",
      "c": "Estresse oxidativo, inflamação, liberação de mediadores inflamatórios e desequilíbrio de proteases levando a destruição da parede alveolar.",
      "d": "Estresse oxidativo, infecção, liberação de mediadores inflamatórios e desequilibrio de proteases levando a destruição da parede alveolar"
    },
    "correta": "a"
  },
  {
    "enunciado": "Influências ambientais e genéticas contribuem para a patogenia da Osteoartrite (OA), a associação com o envelhecimento é forte; a prevalência da OA aumenta exponencialmente após os 50 anos, e cerca de 40% das pessoas com idade superior a 70 anos são afetadas. A figura abaixo mostra o aspecto macroscópico dessa patologia. Assinale a alternativa que corresponda aos números 1, 2 e 3",
    "imagem": "https://i.imgur.com/dlXs2SK.png",
    "alternativas": {
      "a": "(1) Superficie articular degenerada expondo osso subcondral, (2) cisto subcondral e (3) cartilagem articular residual.",
      "b": "(1) Superficie articular degenerada expondo osso subcondral, (2) cartilagem articular residual e (3) cisto subcondral",
      "c": "(1) Cartilagem articular residual, (2) cisto subcondral e (3) Superfície articular degenerada expondo osso subcondral.",
      "d": "(1) Cartilagem articular residual, (2) Superficie articular degenerada expondo osso subcondral e (3) cisto subcondral"
    },
    "correta": "a"
  },
  {
    "enunciado": "Quanto ao armazenamento da vitamina B12 é correto afirmar que:",
    "imagem": null,
    "alternativas": {
      "a": "Não é armazenada no organismo, visto que é uma vitamina lipossolúvel.",
      "b": "É armazenada no fígado em grande quantidade. Seu estoque pode durar vários anos.",
      "c": "É armazenada na medula óssea, devido a alta necessidade de síntese de DNA.",
      "d": "É armazenada no figado em pequena quantidade. Seu estoque dura poucos meses."
    },
    "correta": "b"
  },
  {
    "enunciado": "Assinale a alternativa que identifique a forma em que a cobalamina se encontra para atuar como cofator da enzima metionina sintase.",
    "imagem": null,
    "alternativas": {
      "a": "Etilcobalamina.",
      "b": "Metilcobalamina.",
      "c": "Metacobalamina.",
      "d": "Metionilcobalamina."
    },
    "correta": "b"
  },
  {
    "enunciado": "A região da face mediastinal de cada pulmão que dá passagem aos brônquios e aos vasos pulmonares é denominada:",
    "imagem": null,
    "alternativas": {
      "a": "raiz do pulmão;",
      "b": "pedículo pulmonar.",
      "c": "hilo pulmonar;",
      "d": "ligamento pulmonar;"
    },
    "correta": "c"
  },
  {
    "enunciado": "Na posição anatômica, o ponto mais baixo da cavidade pleural é o recesso:",
    "imagem": null,
    "alternativas": {
      "a": "retroesofágico.;",
      "b": "costodiafragmático;",
      "c": "costomediastinal.",
      "d": "costopulmonar,"
    },
    "correta": "b"
  },
  {
    "enunciado": "Durante as aulas de Educação Física do ensino médio, Joãozinho praticou as modalidades de basquetebol, futebol e corrida de 100 metros rasos. Ao iniciar as aulas de Anatomia no Ensino Superior e lembrar-se das práticas esportivas do Ensino Médio, Joãozinho percebe que uma das articulações muito utilizada nesses esportes era a articulação do quadril. Marque a alternativa que apresenta corretamente a classificação estrutural e o tipo dessa articulação.",
    "imagem": null,
    "alternativas": {
      "a": "Articulação sinovial; triaxial esferóidea.",
      "b": "Articulação fibrosa; triaxial esferóidea.",
      "c": "Articulação fibrosa; biaxial ginglimo.",
      "d": "Articulação sinovial; biaxial ginglimo."
    },
    "correta": "a"
  },
  {
    "enunciado": "Em relação ao sistema excitocondutor do coração, assinale a afirmativa correta:",
    "imagem": null,
    "alternativas": {
      "a": "no nó atrioventricular ocorre uma aceleração na passagem do impulso cardíaco;",
      "b": "o nó atrioventricular é o marcapasso cardiaco;",
      "c": "os feixes internodais situam-se na parede atrial esquerda;",
      "d": "o nó sinoatrial situa-se junto à desembocadura da veia cava superior"
    },
    "correta": "d"
  },
  {
    "enunciado": "Em relação ao complexo estimulante do coração podemos afirmar que:",
    "imagem": null,
    "alternativas": {
      "a": "o suprimento arterial do nó atrioventricular geralmente é dado por um ramo da a. coronária esquerda.",
      "b": "o suprimento arterial do nó sinoatrial é dado por um ramo da a. coronária direita (em 60% dos casos).",
      "c": "a trabécula septomarginal corresponde a ramos subendocárdicos do ramo esquerdo do fascículo atrioventricular.",
      "d": "a estimulação parassimpática do nó sinoatrial leva a uma taquicardia."
    },
    "correta": "b"
  },
  {
    "enunciado": "São ramos da artéria coronária esquerda:",
    "imagem": null,
    "alternativas": {
      "a": "ramos laterais esquerdos e circunflexo;",
      "b": "ramo descendente anterior e circunflexo;",
      "c": "ramo descendente posterior e circunflexo.",
      "d": "ramos descendentes anterior e posterior;"
    },
    "correta": "b"
  },
  {
    "enunciado": "Assinale a associação correta músculo-ação:",
    "imagem": null,
    "alternativas": {
      "a": "reto femoral - extensor da coxa no quadril.",
      "b": "piriforme - rotador medial da coxa no quadril;",
      "c": "glúteo máximo - extensor da coxa no quadril;",
      "d": "biceps femoral - adutor da coxa no quadril;"
    },
    "correta": "c"
  },
  {
    "enunciado": "Durante uma cinecoronariografia (radiografia das artérias coronárias) observa-se que a artéria interventricular posterior é ramo da artéria circunflexa e envia ramos para as paredes de ambos os ventrículos. Esta observação leva-nos a pensar em caso de:",
    "imagem": null,
    "alternativas": {
      "a": "coronária esquerda dominante;",
      "b": "coronária direita dominante;",
      "c": "depende da artéria que ocupa o sulco interventricular anterior.",
      "d": "circulação balanceada;"
    },
    "correta": "a"
  },
  {
    "enunciado": "A pata de ganso (pes anserinus) é formada pelos tendões dos músculos:",
    "imagem": null,
    "alternativas": {
      "a": "semimembranáceo, grácil e sartório;",
      "b": "semimembranáceo, semitendíneo e grácil.",
      "c": "semitendíneo, grácil e sartório;",
      "d": "semitendineo, semimembranáceo e sartório;"
    },
    "correta": "c"
  },
  {
    "enunciado": "Devido às diferenças na divisão da traqueia, um corpo estranho aspirado pela laringe se localizará (com maior frequência) em que local?",
    "imagem": null,
    "alternativas": {
      "a": "brônquio principal esquerdo;",
      "b": "na traquéia.",
      "c": "brônquio principal direito;",
      "d": "na carina;"
    },
    "correta": "c"
  },
  {
    "enunciado": "Sobre a absorção do folato, assinale a alternativa correta:",
    "imagem": null,
    "alternativas": {
      "a": "O ácido fólico é absorvido na forma conjugada com o fator intrinseco.",
      "b": "A vitamina B9 sempre é absorvida na forma de folato.",
      "c": "O ácido fólico é absorvido na presença de cálcio na forma de folato.",
      "d": "O folato é absorvido na forma de monoglutamato."
    },
    "correta": "d"
  },
  {
    "enunciado": "Com relação ao armazenamento da vitamina B9 no figado, selecione a alternativa correta:",
    "imagem": null,
    "alternativas": {
      "a": "Armazenada em grande quantidade na forma de poliglutamato de ácido fólico.",
      "b": "Armazenada em pequena quantidade na forma de poliglutamato de ácido fólico.",
      "c": "Armazenada em grande quantidade na forma de monoglutamato de ácido fólico.",
      "d": "Armazenada em pequena quantidade na forma de monoglutamato de ácido fólico."
    },
    "correta": "b"
  },
  {
    "enunciado": "Com relação aos achados no hemograma durante a anemia megaloblástica, analise as afirmativas a seguir:\nI- O HCM estará aumentado porque a quantidade de hemoglobina (peso) é proporcional ao tamanho celular e a quantidade reduzida de eritrócitos no sangue periférico do paciente.\nII- Presença de eritroblastos no sangue periférico (observação incluída no laudo laboratorial).\nIII- CHCM estará diminuído devido à redução de eritrócitos circulantes no sangue periférico.\nAssinale a alternativa que contenha as afirmativas corretas:",
    "imagem": null,
    "alternativas": {
      "a": "Somente as afirmativas I e III estão corretas.",
      "b": "Somente a afirmativa III está correta.",
      "c": "Somente as afirmativas II e III estão corretas.",
      "d": "Somente as afirmativas I e II estão corretas."
    },
    "correta": "d"
  },
  {
    "enunciado": "De acordo com a Organização Mundial da Saúde, o parâmetro que indica anemia é a (o):",
    "imagem": null,
    "alternativas": {
      "a": "Contagem de eritrócitos.",
      "b": "Dosagem de hemoglobina.",
      "c": "Hematócrito.",
      "d": "Volume Corpuscular Médio."
    },
    "correta": "b"
  },
  {
    "enunciado": "Leia as assertivas abaixo quanto a deficiência de vitamina B12 e a hematopoese:\nI – A deficiência de vitamina B12 afeta a formação de todas as células do sangue, visto que prejudica a formação de DNA.\nII – Neutrófilos hipersegmentados, com mais de 5 lóbulos, são observados com frequência na deficiência da vitamina B12.\nIII – Aumento na contagem de plaquetas é comum na deficiência da vitamina B12",
    "imagem": null,
    "alternativas": {
      "a": "Apenas I e II estão corretas.",
      "b": "Todas estão corretas.",
      "c": "Apenas I e III estão corretas.",
      "d": "Apenas II e III estão corretas."
    },
    "correta": "a"
  },
  {
    "enunciado": "A célula tronco pluripotente é responsável por originar as células do sangue. Quanto às divisões mitóticas que essa célula realiza, é correto afirmar que:",
    "imagem": null,
    "alternativas": {
      "a": "Divisão simétrica se refere apenas a formação de duas células tronco pluripotentes filhas, com o objetivo de auto-renovação.",
      "b": "Divisão simétrica se refere tanto a auto-renovação quanto a formação de células filhas que irão se diferenciar nas células do sangue.",
      "c": "Divisão simétrica se refere apenas a formação de duas células tronco destinadas a diferenciação, ou seja, formação das células sanguíneas.",
      "d": "Divisão assimétrica não ocorre nas células tronco pluripotentes encontradas na medula óssea."
    },
    "correta": "b"
  },
  {
    "enunciado": "A alteração indicada pelas setas azuis e pretas na imagem, se refere a:",
    "imagem": "https://i.imgur.com/8Rq1q3v.png",
    "alternativas": {
      "a": "Anisocitose, que é indicada através do VCM.",
      "b": "Anisocitose, que é indicada através do RDW.",
      "c": "Poiquilocitose, que é observada na microscopia.",
      "d": "Poiquilocitose, que é indicada apenas através do RDW."
    },
    "correta": "b"
  },
  {
    "enunciado": "Se ocorrer redução do número de mitoses que ocorrem no compartimento de reprodução da eritropoese, espera-se que os eritrócitos maduros estejam:",
    "imagem": null,
    "alternativas": {
      "a": "Macrocíticos.",
      "b": "Microciticos.",
      "c": "Normociticos.",
      "d": "Hipercrômicos."
    },
    "correta": "a"
  },
  {
    "enunciado": "Várias substâncias endógenas e exógenas atuam como fatores que estimulam a eritropoese. Com relação a estes fatores assinale a alternativa correta.",
    "imagem": null,
    "alternativas": {
      "a": "A eritropoetina é um fator exógeno renal que atua na fase de proliferação que envolve o pró-eritroblasto, eritroblasto acidófilo e eritroblasto policromático, assim como na fase de maturação que envolve o eritroblasto ortocromático, reticulócito e eritrocito.",
      "b": "A eritropoietina e o folato, fatores exógenos, atuam na fase de proliferação da eritropoese que envolve o pró-eritroblasto, eritroblasto basófilo e eritroblasto policromático.",
      "c": "A vitamina B12 e o ferro, fatores exógenos, atuam na fase de proliferação e maturação, respectivamente.",
      "d": "A eritropoietina é um fator endógeno que atua na fase de proliferação que envolve o eritroblasto ortocromático, reticulócito e eritrocito, assim como na fase de maturação que envolve o pró-eritroblasto, eritroblasto basófilo e eritroblasto policromático."
    },
    "correta": "c"
  },
  {
    "enunciado": "Qual o nome do leucocito que quando visto na microscopia óptica, não é possível observar seu núcleo por estar coberto por grânulos citoplasmáticos pretos?",
    "imagem": null,
    "alternativas": {
      "a": "Basófilo.",
      "b": "Monócito.",
      "c": "Neutrófilo.",
      "d": "Eosinófilo."
    },
    "correta": "a"
  },
  {
    "enunciado": "Qual leucocito pode não ser encontrado no sangue periférico e sua ausência não tem significado clinico?",
    "imagem": null,
    "alternativas": {
      "a": "Eosinófilo.",
      "b": "Monócito.",
      "c": "Linfócito.",
      "d": "Basófilo."
    },
    "correta": "d"
  },
  {
    "enunciado": "Qual leucocito pode estar acima do valor de referência em doenças inflamatórias crônicas?",
    "imagem": null,
    "alternativas": {
      "a": "Basófilo.",
      "b": "Linfocito.",
      "c": "Eosinófilo.",
      "d": "Monócito."
    },
    "correta": "d"
  },
  {
    "enunciado": "Um homem de 45 anos de idade chega na emergência de um hospital com uma história de duas semanas de diarreia que piorou progressivamente ao longo dos últimos dias. Ele tem produzido o mínimo de urina e foi internado no hospital por desidratação. Sua amostra de fezes é positiva para ovos de parasitas. Que tipo de célula teria um número elevado no leucograma?",
    "imagem": null,
    "alternativas": {
      "a": "Linfócito.",
      "b": "Eosinófilo.",
      "c": "Neutrófilo.",
      "d": "Monócito."
    },
    "correta": "b"
  },
  {
    "enunciado": "Levando em consideração a formação dos neutrófilos na medula óssea e a maturação de seus precursores, das situações abaixo qual pode caracterizar desvio a esquerda escalonado?",
    "imagem": null,
    "alternativas": {
      "a": "Presença de bastonetes em maior quantidade que neutrófilos",
      "b": "Presença de bastonetes acima do valor de referência em maior quantidade que metamielócitos.",
      "c": "Presença de mielócitos em maior quantidade que metamielócitos.",
      "d": "Presença de pró-mielócito em maior quantidade que mielócitos."
    },
    "correta": "b"
  },
  {
    "enunciado": "Doenças alérgicas e parasitárias apresentarão em um leucograma possivelmente uma:",
    "imagem": null,
    "alternativas": {
      "a": "Linfocitose.",
      "b": "Monocitopenia.",
      "c": "Eosinofilia.",
      "d": "Neutropenia."
    },
    "correta": "c"
  },
  {
    "enunciado": "Quanto a morfologia dos neutrófilos, é possível afirmar que:",
    "imagem": null,
    "alternativas": {
      "a": "Núcleo bilobulado, excêntrico, cromatina grosseira e homogênea, nucléolos ausentes. Citoplasma eosinofilico, com granulações numerosa e moderadamente grosseiras.",
      "b": "Possui núcleo com três a cinco lóbulos e excêntrico, cromatina grosseira e homogênea, nucléolos ausentes. Citoplasma acidófilo, com granulações delicadas presentes em alta quantidade.",
      "c": "Núcleo com três a cinco lóbulos e excêntrico, cromatina grosseira e homogênea, nucléolos ausentes. Citoplasma eosinofilico, com granulações numerosas e moderadamente grosseiras.",
      "d": "Núcleo bilobulado de forma bizarra e excêntrico, de dificil visibilização, cromatina grosseira e homogênea, nucléolos ausentes. Citoplasma com coloração escura devido a presença de muitas granulações basófilas grosseiras."
    },
    "correta": "b"
  },
  {
    "enunciado": "O exame laboratorial que estará alterado desde o estágio I de deficiência do ferro é:",
    "imagem": null,
    "alternativas": {
      "a": "Ferro sérico.",
      "b": "Saturação de transferrina.",
      "c": "Ferrtina.",
      "d": "Dosagem de hemoglobina."
    },
    "correta": "c"
  },
  {
    "enunciado": "Quanto aos exames laboratoriais que avaliam o ferro é possível afirmar que:",
    "imagem": null,
    "alternativas": {
      "a": "A capacidade total de ligação do ferro se refere a soma dos sítios de ligação da transferina, independentes se estão livres ou ocupados pelo ferro.",
      "b": "A saturação da transferrina se refere a soma dos sítios de ligação da transferina, independentes se estão livres ou ocupados pelo ferro.",
      "c": "Um paciente com deficiência de ferro apresenta a saturação de transferrina elevada e a capacidade total de ligação do ferro reduzida.",
      "d": "Um paciente com deficiência de ferro apresenta redução na dosagem de ferro sérico e níveis normais de ferritina."
    },
    "correta": "a"
  },
 {
    "enunciado": "O folato, oriundo dos alimentos, é ingerido em sua forma inativa que é chamada de:",
    "imagem": null,
    "alternativas": {
      "a": "Metiltetrahidrofolato.",
      "b": "Monoglutamato de ácido fólico.",
      "c": "Tetrahidrofolato.",
      "d": "Poliglutamato de ácido fólico."
    },
    "correta": "d"
  },
  {
    "enunciado": "Com relação ao armazenamento da vitamina B9 no fígado, selecione a alternativa correta:",
    "imagem": null,
    "alternativas": {
      "a": "Armazenada em pequena quantidade na forma de monoglutamato de ácido fólico.",
      "b": "Armazenada em grande quantidade na forma de poliglutamato de ácido fólico.",
      "c": "Armazenada em grande quantidade na forma de monoglutamato de ácido fólico.",
      "d": "Armazenada em pequena quantidade na forma de poliglutamato de ácido fólico."
    },
    "correta": "d"
  },
  {
    "enunciado": "Uma mulher de 19 anos de idade saudável sofreu um trauma abdominal brusco em um acidente com automóvel. Na admissão ao hospital, o nível inicial de hematócrito era de 33%, mas, na hora seguinte, diminuiu para 28%. Uma paracentese produziu um fluido serossanguíneo. Ela foi levada para ser realizada uma cirurgia, na qual uma laceração no fígado foi reparada e 1L de fluido sanguíneo foi removido da cavidade peritoneal. Seu estado permaneceu estável. A análise da lâmina de sangue realizada 3 dias depois apontou policromasia. Qual dos seguintes achados nas extensões sanguíneas do sangue periférico é o mais provável? Valores de Referência: Ht: 36 a 49%.",
    "imagem": null,
    "alternativas": {
      "a": "Microcitose.",
      "b": "Reticulocitose.",
      "c": "Hipocromia.",
      "d": "Leucocitose."
    },
    "correta": "b"
  },
  {
    "enunciado": "A hematologia estuda, principalmente, os elementos figurados do sangue: hemáceas, leucócitos e plaquetas. Estuda a produção e o estado de normalidade dos elementos do sangue. Para isso alguns termos são utilizados. Assinale a alternativa que apresenta o conceito correto para o termo:",
    "imagem": null,
    "alternativas": {
      "a": "Poiquilocitose é uma alteração na cor da hemácia (glóbulos vermelhos do sangue ou eritrócitos).",
      "b": "Anisocitose é um termo da hematologia que significa disparidade do tamanho, principalmente nas hemácias.",
      "c": "Hipocromia é o termo usado na hematologia para referir-se ao aumento da coloração dos eritrócitos ou hemácias.",
      "d": "Microcitose é o termo utilizado para referir-se ao tamanho aumentado da hemácia por falta de vitamina B 12."
    },
    "correta": "b"
  },
  {
    "enunciado": "De acordo com a Organização Mundial da Saúde, o parâmetro que indica anemia é a (o):",
    "imagem": null,
    "alternativas": {
      "a": "Dosagem de hemoglobina.",
      "b": "Volume Corpuscular Médio.",
      "c": "Hematócrito.",
      "d": "Contagem de eritrócitos."
    },
    "correta": "a"
  },
  {
    "enunciado": "Várias substâncias endógenas e exógenas atuam como fatores que estimulam a eritropoese. Com relação a estes fatores assinale a alternativa correta.",
    "imagem": null,
    "alternativas": {
      "a": "A vitamina B12 e o ferro, fatores exógenos, atuam na fase de proliferação e maturação, respectivamente.",
      "b": "A eritropoietina e o folato, fatores exógenos, atuam na fase de proliferação da eritropoese que envolve o pró-eritroblasto, eritroblasto basófilo e eritroblasto policromático.",
      "c": "A eritropoetina é um fator exógeno renal que atua na fase de proliferação que envolve o pró-eritroblasto, eritroblasto acidófilo e eritroblasto policromático, assim como na fase de maturação que envolve o eritroblasto ortocromático, reticulócito e eritrócito.",
      "d": "A eritropoietina é um fator endógeno que atua na fase de proliferação que envolve o eritroblasto ortocromático, reticulócito e eritrócito, assim como na fase de maturação que envolve o pró-eritroblasto, eritroblasto basófilo e eritroblasto policromático."
    },
    "correta": "a"
  },
  {
    "enunciado": "A alteração indicada pelas setas azuis e pretas na imagem, se refere a:",
    "imagem": null,
    "alternativas": {
      "a": "Poiquilocitose, que é indicada apenas através do RDW.",
      "b": "Anisocitose, que é indicada através do RDW.",
      "c": "Poiquilocitose, que é observada na microscopia.",
      "d": "Anisocitose, que é indicada através do VCM."
    },
    "correta": "b"
  },
  {
    "enunciado": "Leia as assertivas abaixo quanto a deficiência de vitamina B12 e a hematopoese:\n1- A deficiência de vitamina B12 afeta a formação de todas as células do sangue, visto que prejudica a formação de DNA.\nII - Neutrófilos hipersegmentados, com mais de 5 lóbulos, são observados com frequência na deficiência da vitamina B12.\nIII - Aumento na contagem de plaquetas é comum na deficiência da vitamina B12.\nAssinale a alternativa correta:",
    "imagem": null,
    "alternativas": {
      "a": "Apenas I e II estão corretas.",
      "b": "Apenas I e III estão corretas.",
      "c": "Apenas II e III estão corretas.",
      "d": "Todas estão corretas."
    },
    "correta": "a"
  },
  {
    "enunciado": "A alteração indicada pelas setas pretas na imagem, se refere a:",
    "imagem": "https://i.imgur.com/qF5dUFn.png",
    "alternativas": {
      "a": "Poiquilocitose, que é observada na microscopia.",
      "b": "Poiquilocitose, que é indicada apenas através do RDW.",
      "c": "Anisocitose, que é indicada através do RDW.",
      "d": "Anisocitose, que é indicada através do VCM."
    },
    "correta": "c"
  },
  {
    "enunciado": "Selecione os alimentos que sejam fontes de ferro heme e não heme, respectivamente:",
    "imagem": null,
    "alternativas": {
      "a": "Maçã e peixe.",
      "b": "Ovo e cereal.",
      "c": "Banana e leite.",
      "d": "Amêndoa e carne bovina."
    },
    "correta": "b"
  },
  {
    "enunciado": "Quanto aos exames laboratoriais que avaliam o ferro é possível afirmar que:",
    "imagem": null,
    "alternativas": {
      "a": "A saturação da transferrina se refere a soma dos sítios de ligação da transferina, independentes se estão livres ou ocupados pelo ferro.",
      "b": "Um paciente com deficiência de ferro apresenta a saturação de transferrina elevada e a capacidade total de ligação do ferro reduzida.",
      "c": "A capacidade total de ligação do ferro se refere a soma dos sítios de ligação da transferina, independentes se estão livres ou ocupados pelo ferro.",
      "d": "Um paciente com deficiência de ferro apresenta redução na dosagem de ferro sérico e níveis normais de ferritina."
    },
    "correta": "c"
  },
  {
    "enunciado": "Sobre as artérias coronária direita e interventricular anterior podemos afirmar:",
    "imagem": null,
    "alternativas": {
      "a": "São oriundas das aa.aorta e coronária esquerda respectivamente",
      "b": "Tratam-se de vasos que não sofrem anastomoses, nos dois casos",
      "c": "Não são ramos sujeitos a formação de placa de ateroma",
      "d": "Possuem derivações denominadas diagonais em ambos os casos"
    },
    "correta": "a"
  },
  {
    "enunciado": "Quando um indivíduo é acometido por osteoporose as vértebras são frequentemente atingidas. São características que permitem identificar a vértebra lombar:",
    "imagem": null,
    "alternativas": {
      "a": "O processo espinhosos paralelo ao plano horizontal",
      "b": "O processo espinhoso obtuso em relação ao processo transverso",
      "c": "O corpo de igual volume ao segmento cervical",
      "d": "O processo transverso com fossa articular para receber as costelas"
    },
    "correta": "a"
  },
  {
    "enunciado": "A articulação do quadril realiza movimentosd nos eixos:",
    "imagem": null,
    "alternativas": {
      "a": "coronal, axial e sagital",
      "b": "sagital, superior e diagonal",
      "c": "sagital, transversal e longitudinal",
      "d": "longitudinal, tranversal e latero-lateral"
    },
    "correta": "c"
  },
  {
    "enunciado": "Comparando a histologia de pele grossa e pele fina, podemos afirmar que:",
    "imagem": null,
    "alternativas": {
      "a": "A pele fina apresenta uma camada córnea mais desenvolvida",
      "b": "Na pele grossa as papilas dérmicas são pouco desenvolvidas em relação a pele fina",
      "c": "Na pele fina a epiderme é mais espessa em relação a pele grossa",
      "d": "Na pele fina estão presentes numerosos pelos e glândulas sebácias"
    },
    "correta": "d"
  },
  {
    "enunciado": "A flexão plantar do pé é realizada",
    "imagem": null,
    "alternativas": {
      "a": "por músculos da coxa cujo tendão vai até o calcâneo",
      "b": "pelo músculo tibial anterior apenas",
      "c": "pelos músculos fibular longo e fibular curto",
      "d": "por músculos da panturrilha, incluindo o m. tríceps sural"
    },
    "correta": "d"
  },
  {
    "enunciado": "Em relação as características histológicas da árvore bronquial, é correto afirmar que:",
    "imagem": null,
    "alternativas": {
      "a": "O brônquios não possuem cartilagem em sua parede, predominando músculo liso",
      "b": "Os anéis que cartilagem da traqueia são constituídos de cartilagem elástica",
      "c": "Os pneumócitos do tipo II são encontrados na parede dos bronquíolos",
      "d": "Os bronquíolos são caracterizados pela ausência de cartilagem em sua parede"
    },
    "correta": "d"
  },
  {
    "enunciado": "São músculos que flexionam a coxa:",
    "imagem": null,
    "alternativas": {
      "a": "tríceps, semitendíneo, semimembranáceo, bíceps",
      "b": "bíceps, quadríceps, sartório, grácil",
      "c": "semitendíneo, semimembranáceo, grácil, sartório",
      "d": "pectíneo, sartório, quadríceps, iliopsoas"
    },
    "correta": "d"
  },
  {
    "enunciado": "O mediastino é o espaço delimitado pela abertura superior do tórax, pelo diafragma e pelas pleuras pulmonares. O coração está localizado:",
    "imagem": null,
    "alternativas": {
      "a": "No mediastino inferior, medialmente",
      "b": "Parte no mediastino superior e parte no mediastino médio",
      "c": "O mediastino não apresenta subdivisões precisas sendo a região ocupada predominantemente pelo coração e pulmões",
      "d": "As estruturas vasculares estão localizadas no mediastino anterior e o coração no mediastino posterior"
    },
    "correta": "a"
  },
  {
    "enunciado": "O joelho é classificado morfologicamente como uma articulação:",
    "imagem": null,
    "alternativas": {
      "a": "Plana",
      "b": "Esferoidea",
      "c": "Trocoidea",
      "d": "Bicondilar"
    },
    "correta": "d"
  },
  {
    "enunciado": "Os pulmões são atravessados por duas circulações, a pulmonar, que sofre hematose e a sistêmica. Os vasos relacionados a esta última são representados pelas:",
    "imagem": null,
    "alternativas": {
      "a": "Artérias torácicas, que são subdivisões da artéria pulmonar",
      "b": "Artérias pulmonares, que transportam sangue arterial",
      "c": "Veias pulmonares, responsáveis pela entrada de oxigênio nos pulmões",
      "d": "Artérias brônquicas, que são ramos colaterais da aorta torácica"
    },
    "correta": "d"
  },
  {
    "enunciado": "Qual leucocito pode não ser encontrado no sangue periférico e sua ausência não tem significado clinico?",
    "imagem": null,
    "alternativas": {
      "a": "Linfócito.",
      "b": "Basófilo.",
      "c": "Monócito.",
      "d": "Eosinófilo."
    },
    "correta": "b"
  },
  {
    "enunciado": "Quanto a morfologia dos neutrófilos, é possível afirmar que:",
    "imagem": null,
    "alternativas": {
      "a": "Núcleo com três a cinco lóbulos e excêntrico, cromatina grosseira e homogênea, nucléolos ausentes. Citoplasma eosinofílico, com granulações numerosas e moderadamente grosseiras.",
      "b": "Núcleo bilobulado, excêntrico, cromatina grosseira e homogênea, nucléolos ausentes. Citoplasma eosinofílico, com granulações numerosa e moderadamente grosseiras.",
      "c": "Possui núcleo com três a cinco lóbulos e excêntrico, cromatina grosseira e homogênea, nucléolos ausentes. Citoplasma acidófilo, com granulações delicadas presentes em alta quantidade.",
      "d": "Núcleo bilobulado de forma bizarra e excêntrico, de difícil visibilização, cromatina grosseira e homogênea, nucléolos ausentes. Citoplasma com coloração escura devido a presença de muitas granulações basófilas grosseiras."
    },
    "correta": "c"
  },
  {
    "enunciado": "O leucócito indicado pela seta na imagem, pode ser encontrado no sangue acima do seu valor de referência no caso de:",
    "imagem": null,
    "alternativas": {
      "a": "Inflamação aguda.",
      "b": "Infecção viral.",
      "c": "Infecção bacteriana.",
      "d": "Processos alérgicos."
    },
    "correta": "b"
  },
  {
    "enunciado": "Levando em consideração a formação dos neutrófilos na medula óssea e a maturação de seus precursores, qual das situações abaixo pode caracterizar desvio à esquerda não escalonado?",
    "imagem": null,
    "alternativas": {
      "a": "Presença de bastonetes em maior quantidade que metamielócitos.",
      "b": "Presença de neutrófilos em maior quantidade que bastonetes.",
      "c": "Presença de metamielócitos em maior quantidade que mielócitos.",
      "d": "Presença de mielócitos em maior quantidade que metamielócitos."
    },
    "correta": "d"
  },
  {
    "enunciado": "Qual o nome do leucócito que quando visto na microscopia óptica, não é possível observar seu núcleo por estar coberto por grânulos citoplasmáticos pretos?",
    "imagem": null,
    "alternativas": {
      "a": "Neutrófilo.",
      "b": "Eosinófilo.",
      "c": "Basófilo.",
      "d": "Monócito."
    },
    "correta": "c"
  },
  {
    "enunciado": "Infecção é definida como a penetração, alojamento e multiplicação do agente infeccioso no hospedeiro, determinando a ocorrência de reação a si próprio ou a seus produtos tóxicos, no local onde se encontram ou a distância. Em reações inflamatórias bacterianas agudas qual característica é mais provável de ser evidenciada no leucograma?",
    "imagem": null,
    "alternativas": {
      "a": "Leucopenia.",
      "b": "Neutrofilia.",
      "c": "Linfocitose.",
      "d": "Monocitose."
    },
    "correta": "b"
  },
  {
    "enunciado": "Um homem de 45 anos de idade chega na emergência de um hospital com uma história de duas semanas de diarreia que piorou progressivamente ao longo dos últimos dias. Ele tem produzido o mínimo de urina e foi internado no hospital por desidratação. Sua amostra de fezes é positiva para ovos de parasitas. Que tipo de célula teria um número elevado no leucograma?",
    "imagem": null,
    "alternativas": {
      "a": "Linfócito.",
      "b": "Monócito.",
      "c": "Neutrófilo.",
      "d": "Eosinófilo."
    },
    "correta": "d"
  },
  {
    "enunciado": "As células da mucosa gástrica são essenciais para o processo de digestão e absorção de diversos nutrientes. Levando em consideração os micronutrientes estudados nesse módulo é correto afirmar que:",
    "imagem": null,
    "alternativas": {
      "a": "As células principais produzem transcobalamina, essencial para o transporte da cianocobalamina após sua absorção.",
      "b": "As células principais produzem o fator intrínseco, essencial para a absorção da cianocobalamina no íleo.",
      "c": "As células parietais produzem o fator intrínseco, essencial para a absorção da cianocobalamina no ileo.",
      "d": "As células parietais produzem transcobalamina, essencial para o transporte da cianocobalamina após sua absorção."
    },
    "correta": "c"
  },
  {
    "enunciado": "A deficiência de qual das seguintes vitaminas pode levar à anemia megaloblástica?",
    "imagem": null,
    "alternativas": {
      "a": "Vitamina D.",
      "b": "Vitamina B12.",
      "c": "Vitamina B6.",
      "d": "Vitamina C."
    },
    "correta": "b"
  },
  {
    "enunciado": "A aterosclerose é a base da patogenia das doenças vasculares periféricas, cerebral e coronariana, causando mais morbidade e mortalidade (aproximadamente metade dos óbitos) no mundo ocidental que qualquer outra doença. A probabilidade de desenvolver a aterosclerose é determinada pela combinação de fatores de riscos adquiridos e hereditários. A figura abaixo mostra a microscopia de uma artéria com aterosclerose, assinale a alternativa que caracterize a composição da letra C, na lâmina:",
    "imagem": "https://ii.mgur.com/a/jxQgMcR.png",
    "alternativas": {
      "a": "C: centro necrótico: dedritos celulares, cristais de colesterol, células espumosas e cálcio.",
      "b": "C: centro necrótico: células musculares lisas, cristais de colesterol e células espumosas.",
      "c": "C: centro necrótico: linfócitos, macrófagos, cristais de colesterol e células espumosas.",
      "d": "C: centro necrótico: macrófagos, cristais de colesterol e células espumosas."
    },
    "correta": "a"
  },
  {
    "enunciado": "A micróglia é constituída por células fagocíticas derivadas do mesoderma que atuam como macrófagos residentes no SNC. Elas compartilham muitos marcadores de superfície com monócitos/macrófagos periféricos. Quando há lesão, essas células modificam a morfologia, figura abaixo, dentre essas modificações tem -se:",
    "imagem": "https://i.imgur.com/qoxYt57.png",
    "alternativas": {
      "a": "Perda de prolongamentos, forma arredondada, são macrófagos com capacidade fagocitária, chamadas células granulo-adiposas.",
      "b": "Aumento de prolongamentos, forma arredondada, são macrófagos com capacidade fagocitária, chamadas células granulo-adiposas.",
      "c": "Perda de prolongamentos, forma arredondada, são fibroblastos com capacidade fagocitária, chamadas células granulo-adiposas.",
      "d": "Aumento de prolongamentos, forma arredondada, são fibroblastos com capacidade fagocitária, chamadas células granulo-adiposas."
    },
    "correta": "a"
  },
  {
    "enunciado": "A DPOC constitui um problema de saúde pública importante. Há uma clara associação entre o tabagismo pesado e o enfisema, e as mulheres e afro-americanos são mais suscetíveis que outros grupos. Aproximadamente 35%-50% de fumantes pesados desenvolvem DPOC; de maneira inversa, 80% da DPOC se desenvolve por causa do tabagismo. A figura abaixo, mostra a macroscopia e microscopia do pulmão com enfisema pulmonar, dentre os fatores que levam a essa patologia, tem-se:",
    "imagem": "https://i.imgur.com/6qCSJjs.png",
    "alternativas": {
      "a": "Estresse oxidativo, aumento de apoptose, senescência, liberação de mediadores inflamatórios e desequilíbrio de proteases levando a destruição da parede alveolar.",
      "b": "Estresse oxidativo, hipersercreção de muco, liberação de mediadores inflamatórios e desequilíbrio de proteases levando a destruição da parede alveolar",
      "c": "Estresse oxidativo, inflamação, liberação de mediadores inflamatórios e desequilíbrio de proteases levando a destruição da parede alveolar.",
      "d": "Estresse oxidativo, infecção, liberação de mediadores inflamatórios e desequilíbrio de proteases levando a destruição da parede alveolar"
    },
    "correta": "a"
  },
  {
    "enunciado": "A população de idosos nos próximos anos, pode chegar a mais de 30 milhões no Brasil. O envelhecimento é um processo natural, no qual o organismo sofre alterações fisiológicas. Sendo assim, sobre a lipofucsina, figura, assinale a alternativa correta:",
    "imagem": null,
    "alternativas": {
      "a": "É um pigmento intracelular, marcador do envelhecimento, endógeno, de cor amarelo- acastanhado",
      "b": "É um pigmento intracelular, marcador do envelhecimento, exógeno, de cor amarelo- acastanhado",
      "c": "É um pigmento extracelular, marcador do envelhecimento, endógeno, de cor amarelo- acastanhado",
      "d": "É um pigmento extracelular, marcador do envelhecimento, exógeno, de cor amarelo- acastanhado"
    },
    "correta": "a"
  },
  {
    "enunciado": "Dentre os sintomas característicos da osteoartrite, tem se dor profunda que piora com o uso, rigidez matinal, crepitação e limitação da amplitude de movimentos. Em relação as características microscópicas (figura), pode se observar:",
    "imagem": null,
    "alternativas": {
      "a": "Aumento de conteúdo aquoso da matriz e diminuição de concentração de proteoglicanas, as fibras de colágeno tipo II na zona superficial são clivadas, os condrócitos morrem e porções de cartilagem em toda a sua espessura são esmagadas.",
      "b": "Aumento de conteúdo aquoso da matriz e de concentração de proteoglicanas, as fibras de colágeno tipo II na zona superficial são clivadas, os condrócitos morrem e porções de cartilagem em toda a sua espessura são esmagadas.",
      "c": "Aumento de conteúdo aquoso da matriz e diminuição de concentração de proteoglicanas, as fibras de colágeno tipo II na zona superficial são clivadas, os osteócitos morrem e porções de cartilagem em toda a sua espessura são esmagadas.",
      "d": "Aumento de conteúdo aquoso da matriz e de concentração de proteoglicanas, as fibras de colágeno tipo II na zona superficial são clivadas, os osteócitos morrem e porções de cartilagem em toda a sua espessura são esmagadas."
    },
    "correta": "a"
  },
  {
    "enunciado": "A lesão neuronal comumente resulta em morte celular por apoptose ou necrose. A perda de neurônios, que é difícil de detectar sem quantificação formal, pode contribuir ainda para a disfunção. Assim, hipóxia, necrose podem modificar a morfologia de células, como os astrócitos, desta forma, assinale a alternativa que caracterize a microscopia observada na figura abaixo:",
    "imagem": null,
    "alternativas": {
      "a": "Os núcleos dos astrócitos aumentam de tamanho e se tornam vesiculares, desenvolvendo nucléolos proeminentes, o citoplasma anteriormente escasso se expande, essas células são chamadas de astrócitos gemistocíticos.",
      "b": "Os núcleos dos astrócitos diminuem de tamanho e se tornam vesiculares, desenvolvendo nucléolos proeminentes, o citoplasma anteriormente escasso se expande, essas células são chamadas de astrócitos gemistocíticos.",
      "c": "Os núcleos dos astrócitos aumentam de tamanho e se tornam vesiculares, desenvolvendo nucléolos proeminentes, o citoplasma fica escasso, essas células são chamadas de astrócitos gemistocíticos.",
      "d": "Os núcleos dos astrócitos diminuem de tamanho e se tornam vesiculares, desenvolvendo nucléolos proeminentes, o citoplasma fica escasso, essas células são chamadas de astrócitos gemistocíticos."
    },
    "correta": "a"
  },
  {
    "enunciado": "Na esclerose média de Mönckeberg, indivíduos com mais de 50 anos são mais comumente afetados. A figura abaixo pode-se observar as alaterações acometidas por essa considerações. Dentre as características observadas, tem-se:",
    "imagem": "https://i.imgur.com/SC3p7Fe.png",
    "alternativas": {
      "a": "Calcificação das paredes das artérias musculares, que envolvem tipicamente a membrana elástica interna, e não são clinicamente significativas.",
      "b": "Calcificação das paredes das arteríolas, que envolvem tipicamente a membrana elástica interna, e não são clinicamente significativas.",
      "c": "Calcificação das paredes das artérias musculares, que envolvem tipicamente a membrana elástica interna, e são clinicamente significativas.",
      "d": "Calcificação das paredes das arteríolas, que envolvem tipicamente a membrana elástica interna e são clinicamente significativas."
    },
    "correta": "a"
  },
  {
    "enunciado": "O sintoma cardinal da bronquite crônica é a tosse persistente com produção de escarro esparso. Durante muitos anos, nenhum outro prejuízo funcional respiratório está presente, mas, finalmente, surge dispneia aos esforços. Dentre os aspectos macroscópicos dessa patologia, pode-se observar:",
    "imagem": "https://i.imgur.com/ZZj9PYc.png",
    "alternativas": {
      "a": "Hiperemia, tumefação e edema das membranas mucosas, frequentemente acompanhadas pelo excesso de secreções mucinosas ou mucopurulentas.",
      "b": "Atrofia das membranas mucosas, frequentemente acompanhadas pelo excesso de secreções mucinosas ou mucopurulentas",
      "c": "Hiperemia, tumefação e edema das membranas mucosas, frequentemente acompanhadas pela diminuição de secreções mucinosas ou mucopurulentas",
      "d": "Atrofia das membranas mucosas, frequentemente acompanhadas pela diminuição de secreções mucinosas ou mucopurulentas"
    },
    "correta": "a"
  },
  {
    "enunciado": "Influências ambientais e genéticas contribuem para a patogenia da Osteoartrite (OA), a associação com o envelhecimento é forte; a prevalência da OA aumenta exponencialmente após os 50 anos, e cerca de 40% das pessoas com idade superior a 70 anos são afetadas. A figura abaixo mostra o aspecto macroscópico dessa patologia. Assinale a alternativa que corresponda aos números 1, 2 e 3",
    "imagem": "https://i.imgur.com/FbCQpPw.png",
    "alternativas": {
      "a": "(1) Superfície articular degenerada expondo osso subcondral, (2) cisto subcondral e (3) cartilagem articular residual.",
      "b": "(1) Superfície articular degenerada expondo osso subcondral, (2) cartilagem articular residual e (3) cisto subcondral",
      "c": "(1) Cartilagem articular residual, (2) cisto subcondral e (3) Superfície articular degenerada expondo osso subcondral.",
      "d": "(1) Cartilagem articular residual, (2) Superfície articular degenerada expondo osso subcondral e (3) cisto subcondral"
    },
    "correta": "a"
  },
  {
    "enunciado": "As alterações visíveis na pele dos indivíduos idosos são provenientes do próprio processo de envelhecimento cutâneo, da constituição genética, dos fatores ambientais, entre outros. Na figura abaixo, pele de indivíduo jovem (A) e idoso (B), pode se observar:",
    "imagem": null,
    "alternativas": {
      "a": "Fragmentação de fibras elásticas e perda de disposição elástica na parte superior da derme.",
      "b": "Preservação de fibras elásticas e perda de disposição elástica na parte superior da derme.",
      "c": "Fragmentação de fibras colágenas e preservação de disposição elástica na parte superior da epiderme.",
      "d": "Preservação de fibras colágenas e perda de disposição elásticas na parte superior da epiderme"
    },
    "correta": "a"
  },                  
];

        // --- FIM DAS MODIFICAÇÕES PRINCIPAIS ---

        // Variáveis globais (algumas mantidas, outras adaptadas)
        let allQuestions = []; 
        let currentTestQuestions = [];
        let currentQuestionIndex = 0;
        let userAnswers = {};
        let testStatistics = { 
            correct: [],
            incorrect: [],
            attemptsHistory: [],
            performanceByArea: {},
            questionMistakes: {} 
        };
        let answeredQuestions = 0;
        let answeredInBlock = 0;
        let correctInBlock = 0;
        let showFeedbackOnNext = false;
        let currentAttempt = 0; 
        let currentQuizIsReviewMode = false; 
        let hasFinishedCurrentTestProcessing = false;
        let charts = {
            performance: null, progress: null, areas: null, mistakes: null,
            questionSizeChart: null, timePerQuestion: null 
        };

        // Constantes de elementos do DOM
        const quizPage = document.getElementById('quizPage');
        const resultsPage = document.getElementById('resultsPage');
        const currentQuestionDiv = document.getElementById('currentQuestion');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const finishBtn = document.getElementById('finishBtn');
        // const jsonInput = document.getElementById('jsonInput'); // REMOVIDO
        const finalScoreText = document.getElementById('finalScoreText');
        const finalPercentageText = document.getElementById('finalPercentageText');
        const questionsAnalysis = document.getElementById('questionsAnalysis');
        const progressBar = document.getElementById('progressBar');
        const instantFeedback = document.getElementById('instantFeedback');
        
        const feedbackPopup = document.getElementById('feedbackPopup');
        const closeFeedback = document.getElementById('closeFeedback');
        const continueButton = document.getElementById('continueButton');
        const feedbackTotal = document.getElementById('feedbackTotal');
        const feedbackCorrect = document.getElementById('feedbackCorrect');
        const feedbackIncorrect = document.getElementById('feedbackIncorrect');
        const feedbackPercentageValue = document.getElementById('feedbackPercentageValue');
        const feedbackMistakesList = document.getElementById('feedbackMistakesList');
        
        const quizStartOptionsPopup = document.getElementById('quizStartOptionsPopup');
        const quizOptionsPopupTitle = document.getElementById('quizOptionsPopupTitle');
        const quizOptionsPopupSubtitle = document.getElementById('quizOptionsPopupSubtitle');
        const quizOptionsPopupButtons = document.getElementById('quizOptionsPopupButtons');
        
        const questionDetailPopup = document.getElementById('questionDetailPopup');
        const questionDetailContent = document.getElementById('questionDetailContent');

        const darkModeToggle = document.getElementById('darkModeToggle');
        const darkModeText = document.getElementById('darkModeText');
        const darkModeToggleResults = document.getElementById('darkModeToggleResults');
        const darkModeTextResults = document.getElementById('darkModeTextResults');
        
        const toggleAnalysisBtn = document.getElementById('toggleAnalysisBtn');
        const analysisBox = document.getElementById('analysisBox');
        const correctSound = document.getElementById('correctSound');
        const wrongSound = document.getElementById('wrongSound');
        // const jsonFileListElement = document.getElementById('jsonFileList'); // REMOVIDO
        const quizTitleElement = document.getElementById('quizTitle'); 
        const resultsTitleElement = document.getElementById('resultsTitle');
        const resetStatsBtn = document.getElementById('resetStatsBtn');


       const iframes = [
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/lista-mais-g-y-do-planeta-terra-2-0-1308/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/eu-quero-comer-voce-99397/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/rat-dance-music-93451/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/pou-estourado-48183/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/sua-mae-sabe-que-voce-gosta-de-rapazes-80078/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/toma-milk-shake-de-morango-59364/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/rojao-super-estourado-44057/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/me-da-minha-foia-19424/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/vai-tomar-no-c-pir4nh444-34654/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/lula-e-neymar-47-40647/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/e-agora-vai-entra-o-grosso-75362/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/caramba-que-p1nto-enorme-42382/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/o-homem-uma-maquina-uma-besta-enjaulada-66045/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/manda-foto-pivete-4508/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/som-do-zap-zap-estourado-15594/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/lula-empurra-mole-59742/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/foi-quando-gyro-finalmente-entendeu-41342/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/uicideboy-intro-gmi2-36329/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/abc-da-amazonia-61531/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/corinthians-radio-globo/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/cruzeiro-radio-globo/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/eae-mane-cade-o-pix-mwahahaha-8598/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/posso-te-ligar-agora-ou-tua-mulher-54107/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/para-de-mandar-audio-to-na-ucrania-47141/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/ponte-preta-radio-globo-91750/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/coritiba-radio-globo/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/dolly-estourado-50496/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/imbroxavel-44092/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/lula-ze-gotinha-26753/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/hino-da-urss-53471/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/lobo-pidao-50489/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/voce-vem-almocar-23752/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/vinheta-ifood/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/spongebob-fail-11236/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/botao-do-whatsapp-97196/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/1-2-3-4-flamengo-18569/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/ai-chavinho-25347/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/tralalero-funk-20181/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/indian-song-7sek-58379/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/hello-moto-estourado-73372/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/plantao-globo/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/aw-shit-here-go-again-cj-from-gta-sa-97151/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/cala-a-boca-e-escuta-o-som-da-minha-kombi-ai-2767/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/qui-fase-que-ta-o-curintia-43357/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/musica-triste-meme-41946/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/pare/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/me-ferrei-amigos-estevao-31478/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/ele-ta-pedindo-pra-ser-empurrado-4066/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/papu-papu-papu-58837/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/biometria-13888/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/brasil-radio-globo/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/agostinho-carrara-autonomo-28476/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/freddie/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/bem-te-vi-passaro-58874/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/grito-do-tom-35478/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/what-bottom-text-meme-sanctuary-guardian-s-24591/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/acorda-monark-17462/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/me-mata-de-uma-vez-trio-parada-dura-572/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/me-mata-de-uma-vez-31687/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/aumenta-o-som-marcelo-dig-dig-dig-74686/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/vinheta-jornal-nacional/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/cr7-bom-dia-34785/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/bad-to-the-bone-meme-22189/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/ai-programa-hora-do-faro-melhor-qualidade-5308/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/donald-trump-build-a-wall/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/quien-estaba-hablando-contigo-73597/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/bom-dia-sao-10h-silvio-santos/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/comercial-de-xampu-de-mulher/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/avocados-fron-mexico-5538/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/comercial-globo-1-621/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/comercial-globo-2-83971/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/e-o-pintinho-piu-26037/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/bilu-o-et-brasileiro/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/som-motor-f1-51289/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/buzina-de-caminhao-byrm-17163/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/caminhao-de-gas/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/re-caminhao-67082/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/o-moco-o-caminhao-tombou-35530/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/toque-do-motorola-28486/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/encara-messi-23845/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/cr7-vou-ao-u-ao-messi-36080/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/linkin-park-in-the-end-versao-forro-brazil-79061/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/vx-without-me-forro-estourado-27992/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/minha-pomba-forro-21153/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/champions-league-forro-42023/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/tu-conhece-a-paola-63959/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/lula-feijao-puro-34490/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/chora-viola/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/sinonimos-chitaozinho-xororo-brasil-27832/embed/" frameborder="0" scrolling="no"></iframe>',
    '<iframe width="110" height="200" src="https://www.myinstants.com/instant/eu-to-maluco-to-doente-to-doidao-14644/embed/" frameborder="0" scrolling="no"></iframe>'
];

        // FUNÇÕES REMOVIDAS: sanitizeFileName, getFileList, saveFileList, renderFileList, deleteFile (relacionadas a múltiplos arquivos)

        /**
         * Salva apenas as estatísticas do simulado embutido no localStorage.
         * @param {object} statsObject - O objeto de estatísticas a ser salvo.
         */
        function saveStats(statsObject) {
            localStorage.setItem(LOCAL_STORAGE_STATS_PREFIX + EMBEDDED_QUIZ_ID, JSON.stringify(statsObject));
        }

        /**
         * Carrega o simulado embutido (questões e estatísticas) e prepara para iniciar.
         */
        function loadEmbeddedQuizAndShowOptions() {
            const displayName = "Simulado Principal"; // Nome fixo para o simulado embutido
            const statsString = localStorage.getItem(LOCAL_STORAGE_STATS_PREFIX + EMBEDDED_QUIZ_ID);

            // Processa as questões embutidas para garantir IDs únicos
            allQuestions = embeddedQuestionsSource.map((q, index) => ({
                ...q,
                id: q.id || `${EMBEDDED_QUIZ_ID}-q-${index}` // Garante um ID para cada questão
            }));

            if (allQuestions.length === 0) {
                currentQuestionDiv.innerHTML = "<p>Erro: Nenhuma questão embutida configurada.</p>";
                alert('Erro: Nenhuma questão embutida encontrada ou formato inválido.');
                resetStatsBtn.disabled = true;
                return;
            }

            quizTitleElement.textContent = `Simulado: ${displayName}`;
            resultsTitleElement.textContent = `Resultados: ${displayName}`;

            if (statsString) {
                testStatistics = JSON.parse(statsString);
                testStatistics.questionMistakes = testStatistics.questionMistakes || {};
                allQuestions.forEach(q => { // Garante que todas as questões atuais tenham uma entrada em questionMistakes
                    if (testStatistics.questionMistakes[q.id] === undefined) {
                        testStatistics.questionMistakes[q.id] = 0;
                    }
                });
                currentAttempt = testStatistics.attemptCount || 0;
            } else { // Se não há estatísticas salvas, inicializa
                testStatistics = { 
                    correct: [], 
                    incorrect: [], 
                    attemptsHistory: [], 
                    performanceByArea: {}, 
                    questionMistakes: {}, 
                    attemptCount: 0 
                };
                allQuestions.forEach(q => { testStatistics.questionMistakes[q.id] = 0; });
                currentAttempt = 0;
            }
            
            resultsPage.style.display = 'none'; 
            quizPage.style.display = 'none'; 
            showQuizStartOptionsPopup(displayName);
            resetStatsBtn.disabled = !statsString; // Habilita se houver estatísticas salvas
        }
        
        /**
         * Exibe o popup com opções para iniciar o simulado.
         * @param {string} displayName - O nome de exibição do simulado.
         */
        function showQuizStartOptionsPopup(displayName) {
            quizOptionsPopupSubtitle.textContent = `Simulado: ${displayName}`;
            quizOptionsPopupButtons.innerHTML = ''; 

            const normalTestButton = document.createElement('button');
            normalTestButton.textContent = 'Prova Normal (40Q)'; // Ou o número de questões embutidas se for menor
            normalTestButton.className = 'popup-button'; 
            normalTestButton.onclick = () => {
                initializeTest(false, Math.min(40, allQuestions.length)); // Ajusta o número de questões se necessário
                closeQuizOptionsPopup();
            };
            quizOptionsPopupButtons.appendChild(normalTestButton);

            const distinctMistakesCount = Object.values(testStatistics.questionMistakes || {}).filter(count => count > 0).length;
            
            // Mostra opção de revisar erros apenas se houver erros registrados
            if (distinctMistakesCount > 0) { 
                const reviewMistakesButton = document.createElement('button');
                const reviewQuizLength = Math.min(10, distinctMistakesCount); 
                reviewMistakesButton.textContent = `Revisar Erros (${reviewQuizLength}Q)`;
                reviewMistakesButton.className = 'popup-button';
                reviewMistakesButton.onclick = () => {
                    initializeTest(true, 10); 
                    closeQuizOptionsPopup();
                };
                quizOptionsPopupButtons.appendChild(reviewMistakesButton);
            }
            
            quizStartOptionsPopup.classList.add('active');
        }

        function closeQuizOptionsPopup() {
            quizStartOptionsPopup.classList.remove('active');
        }
        
        resetStatsBtn.addEventListener('click', () => {
            const currentFileNameForAlert = "Simulado Principal";

            if (confirm(`Tem a certeza que quer resetar todas as estatísticas (histórico de tentativas, erros, etc.) do "${currentFileNameForAlert}"? As questões em si NÃO serão apagadas.`)) {
                testStatistics = { 
                    correct: [],
                    incorrect: [],
                    attemptsHistory: [],
                    performanceByArea: {},
                    questionMistakes: {}, 
                    attemptCount: 0 
                };
                // Re-inicializa a contagem de erros para todas as questões embutidas
                allQuestions.forEach(q => { 
                    testStatistics.questionMistakes[q.id] = 0;
                });

                saveStats(testStatistics); // Salva as estatísticas resetadas
                
                alert("Estatísticas resetadas com sucesso!");
                
                if(resultsPage.style.display === 'block'){
                    resultsPage.style.display = 'none';
                }
                if(quizPage.style.display === 'block'){
                     quizPage.style.display = 'none';
                }
                currentQuestionDiv.innerHTML = ""; // Limpa a área de questão
                
                // Recarrega as opções de início, já que as estatísticas foram alteradas
                loadEmbeddedQuizAndShowOptions();
            }
        });


        function playSound(soundElement) {
            if (soundElement) {
                soundElement.currentTime = 0;
                soundElement.play().catch(e => console.error("Erro ao tocar som:", e));
            }
        }

        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
            const isDark = document.body.classList.contains('dark-mode');
            localStorage.setItem('darkModeGlobalSetting', isDark ? 'enabled' : 'disabled'); 
            const text = isDark ? 'Modo Claro' : 'Modo Escuro';
            darkModeText.textContent = text;
            darkModeTextResults.textContent = text;
            if (resultsPage.style.display === 'block' && currentFileId) updateCharts(); 
        }

        if (localStorage.getItem('darkModeGlobalSetting') === 'enabled') {
            document.body.classList.add('dark-mode');
            darkModeText.textContent = 'Modo Claro';
            darkModeTextResults.textContent = 'Modo Claro';
        } else {
             darkModeText.textContent = 'Modo Escuro';
            darkModeTextResults.textContent = 'Modo Escuro';
        }

        darkModeToggle.addEventListener('click', toggleDarkMode);
        darkModeToggleResults.addEventListener('click', toggleDarkMode);
        closeFeedback.addEventListener('click', () => feedbackPopup.classList.remove('active'));
        
        toggleAnalysisBtn.addEventListener('click', () => {
            const isHidden = analysisBox.style.display === 'none' || analysisBox.style.display === '';
            analysisBox.style.display = isHidden ? 'block' : 'none';
            if (isHidden) {
                toggleAnalysisBtn.innerHTML = '<span class="icon">&#x25B2;</span>Recolher Análise';
                toggleAnalysisBtn.classList.add('expanded');
            } else {
                toggleAnalysisBtn.innerHTML = '<span class="icon">&#x25BC;</span>Expandir Análise';
                toggleAnalysisBtn.classList.remove('expanded');
            }
        });
        
        continueButton.addEventListener('click', () => {
            feedbackPopup.classList.remove('active');
            if (currentQuestionIndex < currentTestQuestions.length - 1) { 
                currentQuestionIndex++;
                displayCurrentQuestion(); 
            } else { // Se era o feedback do último bloco da última questão
                actuallyFinishTest();
            }
        });

        // REMOVIDO: jsonInput.addEventListener('change', ...)

        function initializeTest(isMistakesQuiz = false, numQuestions = 40) {
            instantFeedback.style.display = 'none'; 
            instantFeedback.textContent = '';
            currentQuizIsReviewMode = isMistakesQuiz; 
            hasFinishedCurrentTestProcessing = false; 

            // A verificação de currentFileId não é mais crítica aqui, pois é fixo.
            // allQuestions é preenchido por loadEmbeddedQuizAndShowOptions
            if (allQuestions.length === 0) {
                currentQuestionDiv.innerHTML = "<p>Nenhuma questão carregada. Verifique a configuração das questões embutidas.</p>";
                quizPage.style.display = 'block'; 
                return;
            }
            userAnswers = {}; 
            currentQuestionIndex = 0;
            answeredQuestions = 0;
            answeredInBlock = 0;
            correctInBlock = 0;
            showFeedbackOnNext = false;
            testStatistics.correct = []; 
            testStatistics.incorrect = []; 
            testStatistics.performanceByArea = {}; 
            
            // Incrementa o contador de tentativas apenas para provas normais
            if (!isMistakesQuiz) {
                testStatistics.attemptCount = (testStatistics.attemptCount || 0) + 1;
                currentAttempt = testStatistics.attemptCount; 
                saveStats(testStatistics); // Salva o contador de tentativas atualizado
            }


            if (isMistakesQuiz) {
                currentTestQuestions = getMostMistakenQuestions(allQuestions, numQuestions); 
                if (currentTestQuestions.length === 0 ) {
                    alert("Não há questões erradas para revisar ou elas já foram vistas. Iniciando prova normal.");
                    currentTestQuestions = getRandomQuestions(allQuestions, Math.min(40, allQuestions.length)); 
                    numQuestions = currentTestQuestions.length; // Ajusta numQuestions para o tamanho real
                    currentQuizIsReviewMode = false; 
                } else if (currentTestQuestions.length < numQuestions) {
                    numQuestions = currentTestQuestions.length;
                }
            } else { 
                // Lógica para alternar para revisão de erros a cada X tentativas (ex: 6)
                if (testStatistics.attemptCount > 0 && testStatistics.attemptCount % 6 === 0) { 
                    const mistakenForReview = getMostMistakenQuestions(allQuestions, numQuestions);
                    if (mistakenForReview.length > 0) {
                        currentTestQuestions = mistakenForReview;
                        currentQuizIsReviewMode = true; 
                         if (currentTestQuestions.length < numQuestions) numQuestions = currentTestQuestions.length;
                        alert("Esta é uma rodada de revisão das questões mais erradas!");
                    } else { // Se não há erros para revisar, faz uma prova normal
                        currentTestQuestions = getRandomQuestions(allQuestions, Math.min(numQuestions, allQuestions.length));
                        currentQuizIsReviewMode = false;
                         if (currentTestQuestions.length < numQuestions) numQuestions = currentTestQuestions.length;
                    }
                } else { // Prova normal padrão
                    currentTestQuestions = getRandomQuestions(allQuestions, Math.min(numQuestions, allQuestions.length));
                    currentQuizIsReviewMode = false;
                     if (currentTestQuestions.length < numQuestions) numQuestions = currentTestQuestions.length;
                }
            }
            
            // Garante que não tentaremos exibir mais questões do que temos
            if (currentTestQuestions.length > numQuestions) {
                 currentTestQuestions = currentTestQuestions.slice(0, numQuestions);
            } else {
                numQuestions = currentTestQuestions.length; // Ajusta numQuestions para o número real de questões selecionadas
            }

            if (currentTestQuestions.length === 0 && allQuestions.length > 0) { // Fallback se a seleção de erros não retornar nada
                currentTestQuestions = getRandomQuestions(allQuestions, Math.min(numQuestions, allQuestions.length));
                currentQuizIsReviewMode = false; 
            }


            quizPage.style.display = 'block'; 
            resultsPage.style.display = 'none';
            analysisBox.style.display = 'none'; 
            toggleAnalysisBtn.innerHTML = '<span class="icon">&#x25BC;</span>Expandir Análise';
            toggleAnalysisBtn.classList.remove('expanded');

            if (currentTestQuestions.length > 0) {
                displayCurrentQuestion();
            } else {
                currentQuestionDiv.innerHTML = "<p>Nenhuma questão disponível para este modo de prova.</p>";
                nextBtn.disabled = true;
                finishBtn.style.display = 'none';
            }
            updateProgressBar();
            updateNavigationButtons();
        }

        function getRandomQuestions(questions, count) {
            if (questions.length === 0) return [];
            const availableQuestions = questions.length;
            const numToSelect = Math.min(count, availableQuestions);
            const shuffled = [...questions].sort(() => 0.5 - Math.random());
            return shuffled.slice(0, numToSelect);
        }

        function getMostMistakenQuestions(questions, count) {
            if (questions.length === 0 || !testStatistics.questionMistakes) return [];
            const questionsWithMistakes = questions
                .map(q => ({ ...q, mistakes: testStatistics.questionMistakes[q.id] || 0 }))
                .filter(q => q.mistakes > 0);

            questionsWithMistakes.sort((a, b) => b.mistakes - a.mistakes); // Mais erradas primeiro
            
            const numToSelect = Math.min(count, questionsWithMistakes.length);
            const selected = questionsWithMistakes.slice(0, numToSelect);
            return shuffleArray(selected); // Embaralha as selecionadas para não virem sempre na mesma ordem de erro
        }
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function formatEnunciado(text) {
            if (!text) return '';
            const tableRegex = /(\+[-]+\+[\s\S]*\+[-]+\+)/g; 
            return text.replace(tableRegex, '<pre class="ascii-table">$&</pre>');
        }

        function displayCurrentQuestion() {
            instantFeedback.style.display = 'none'; 

            if (currentTestQuestions.length === 0 || currentQuestionIndex >= currentTestQuestions.length) {
                if (answeredQuestions > 0) actuallyFinishTest(); 
                else currentQuestionDiv.innerHTML = "<p>Fim das questões ou nenhuma questão carregada.</p>";
                return;
            }
            const question = currentTestQuestions[currentQuestionIndex];
            let imageHtml = '';
            if (question.imagem && question.imagem !== 'null') {
                imageHtml = `<img src="${question.imagem}" alt="Imagem da questão" class="question-image">`;
            }
            const formattedEnunciado = formatEnunciado(question.enunciado);

            let starsHtml = '';
            if (currentQuizIsReviewMode && testStatistics.questionMistakes && testStatistics.questionMistakes[question.id]) {
                const errorCount = testStatistics.questionMistakes[question.id];
                if (errorCount > 0) { 
                    let starCount = 0;
                    // Lógica de estrelas: 1 estrela para 1-2 erros, 2 estrelas para 3-4 erros, etc.
                    // Ajuste esta lógica conforme necessário.
                    if (errorCount >= 1 && errorCount <=2) starCount = 1;
                    else if (errorCount >= 3 && errorCount <=4) starCount = 2;
                    else if (errorCount >= 5) starCount = 3; // Máximo de 3 estrelas, por exemplo

                    starCount = Math.min(3, starCount); // Limita o número de estrelas

                    if (starCount > 0) {
                        starsHtml = `<span class="mistake-stars-container">${'⭐'.repeat(starCount)} <span class="mistake-stars-label">(Nível de Erro)</span></span>`;
                    }
                }
            }


            currentQuestionDiv.innerHTML = `
                <div class="question-container" id="questionContainer">
                    <div class="question-number">Questão ${currentQuestionIndex + 1} de ${currentTestQuestions.length} ${starsHtml}</div>
                    <div class="question-text">${formattedEnunciado}</div>
                    ${imageHtml}
                    <div class="options" id="optionsContainer"></div>
                    <div class="correct-answer" id="correctAnswer" style="display:none;">Resposta correta: ${question.correta.toUpperCase()}</div>
                    ${question.explicacao ? `<div class="explanation" id="explanation" style="display:none;">${formatEnunciado(question.explicacao)}</div>` : ''}
                </div>`;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = ''; 
            
            Object.entries(question.alternativas).forEach(([letter, text]) => {
                const optionId = `q${currentQuestionIndex}-opt-${letter}-${Date.now()}`;
                const label = document.createElement('label');
                label.className = 'option';
                label.htmlFor = optionId;

                const radioInput = document.createElement('input');
                radioInput.type = 'radio';
                radioInput.id = optionId;
                radioInput.name = `question-${question.id}`; 
                radioInput.value = letter;

                if (userAnswers[question.id] !== undefined) { // Se a questão já foi respondida nesta tentativa
                    radioInput.checked = (userAnswers[question.id] === letter);
                    radioInput.disabled = true; 
                     if (userAnswers[question.id] === letter) { 
                        label.classList.add(userAnswers[question.id] === question.correta ? 'correct' : 'incorrect', 'selected');
                    } else if (letter === question.correta) { 
                        label.classList.add('correct');
                    }
                }
                
                const letterSpan = document.createElement('span');
                letterSpan.className = 'option-letter-styled';
                letterSpan.textContent = `${letter.toUpperCase()})`;

                const textSpan = document.createElement('span');
                textSpan.className = 'option-actual-text';
                textSpan.textContent = text;

                label.appendChild(radioInput);
                label.appendChild(letterSpan);
                label.appendChild(textSpan);
                optionsContainer.appendChild(label);

                if (!radioInput.disabled) { 
                    label.addEventListener('click', function() {
                        if (userAnswers[question.id] !== undefined) return; 

                        userAnswers[question.id] = radioInput.value;
                        radioInput.checked = true;

                        const isCorrect = radioInput.value === question.correta;
                        playSound(isCorrect ? correctSound : wrongSound);

                        optionsContainer.querySelectorAll('label.option').forEach(optLabel => {
                            const optRadio = optLabel.querySelector('input[type="radio"]');
                            optRadio.disabled = true;
                            optLabel.classList.remove('selected', 'correct', 'incorrect');
                            if (optRadio.value === question.correta) {
                                optLabel.classList.add('correct');
                            }
                            if (optRadio.value === radioInput.value) { 
                                optLabel.classList.add('selected');
                                if (!isCorrect) {
                                    optLabel.classList.add('incorrect');
                                }
                            }
                        });
                        
                        const qContainer = document.getElementById('questionContainer');
                        qContainer.classList.remove('correct', 'incorrect');
                        qContainer.classList.add(isCorrect ? 'correct' : 'incorrect');
                        
                        document.getElementById('correctAnswer').style.display = 'block';
                        const explanationDiv = document.getElementById('explanation');
                        if (explanationDiv) explanationDiv.style.display = 'block';

                        answeredQuestions++;
                        answeredInBlock++;
                        if (isCorrect) correctInBlock++;
                        
                        updateProgressBar();
                        // MODIFICAÇÃO: Mudar bloco de 5 para 10
                        if (answeredInBlock > 0 && answeredInBlock % 10 === 0) { 
                            showFeedbackOnNext = true;
                        }
                        updateNavigationButtons();
                    });
                }
            });

            const qContainer = document.getElementById('questionContainer');
            if (userAnswers[question.id] !== undefined) { // Se já respondida, mostrar estado correto/incorreto
                 document.getElementById('correctAnswer').style.display = 'block';
                 const explanationDiv = document.getElementById('explanation');
                 if (explanationDiv) explanationDiv.style.display = 'block';
                 qContainer.classList.toggle('correct', userAnswers[question.id] === question.correta);
                 qContainer.classList.toggle('incorrect', userAnswers[question.id] !== question.correta);
            }
            
            updateNavigationButtons();
            currentQuestionDiv.scrollIntoView({ behavior: 'smooth', block: 'start' }); 
        }

        function showCongratsPopupWithRandomIframe() {
            const existingPopup = document.querySelector('.congrats-popup');
            if (existingPopup) existingPopup.remove();

            // MODIFICAÇÃO: Usar a variável global 'iframes'
            const randomIframeHtml = iframes[Math.floor(Math.random() * iframes.length)];
            const popup = document.createElement('div');
            popup.className = 'congrats-popup';
            popup.innerHTML = `
                <div class="congrats-content">
                    <p class="congrats-message">Parabéns! Você tirou 7+! (áudios 100% aleatório de um site de áudio, CUIDADO!!) </p>
                    <div class="random-iframe">${randomIframeHtml}</div>
                    <button class="close-popup-button" onclick="this.closest('.congrats-popup').remove()">Fechar</button>
                </div>`;
            document.body.appendChild(popup);
        }
        
        function showBlockFeedback() {
            const totalInBlock = answeredInBlock;
            if (totalInBlock === 0 && !showFeedbackOnNext) { 
                 if (currentQuestionIndex < currentTestQuestions.length - 1) {
                     currentQuestionIndex++; 
                     displayCurrentQuestion(); 
                 } else { 
                     actuallyFinishTest(); 
                 }
                return;
            }
            showFeedbackOnNext = false; 

            const incorrectInBlock = totalInBlock - correctInBlock;
            const percentage = totalInBlock > 0 ? Math.round((correctInBlock / totalInBlock) * 100) : 0;
            
            feedbackTotal.textContent = totalInBlock;
            feedbackCorrect.textContent = correctInBlock;
            feedbackIncorrect.textContent = incorrectInBlock;
            feedbackPercentageValue.textContent = percentage;
            
            feedbackMistakesList.innerHTML = '<h4>Resumo dos erros neste bloco:</h4>';
            let mistakesContent = '';
            
            const blockStartIndex = Math.max(0, (currentQuestionIndex +1) - totalInBlock);


            for(let i = 0; i < totalInBlock; i++) {
                const qIdxInTest = blockStartIndex + i;
                 if (qIdxInTest >= currentTestQuestions.length) continue;

                const question = currentTestQuestions[qIdxInTest];
                const userAnswer = userAnswers[question.id];

                if(userAnswer !== undefined && userAnswer !== question.correta) {
                    mistakesContent += `<div class="feedback-mistake-item">
                        <div class="feedback-mistake-question">Q${qIdxInTest + 1}: ${question.enunciado.substring(0,50)}...</div>
                        <div class="feedback-mistake-option feedback-mistake-selected">Sua Resposta: ${userAnswer.toUpperCase()}) ${question.alternativas[userAnswer]}</div>
                        <div class="feedback-mistake-option feedback-mistake-correct">Correta: ${question.correta.toUpperCase()}) ${question.alternativas[question.correta]}</div>
                    </div>`;
                }
            }
            if(mistakesContent === '') mistakesContent = "<p>Nenhum erro neste bloco. Ótimo!</p>";
            feedbackMistakesList.innerHTML += mistakesContent;
            
            feedbackPopup.classList.add('active');

            if (percentage >= 70) {
                setTimeout(showCongratsPopupWithRandomIframe, 300);
            }
            
            answeredInBlock = 0; 
            correctInBlock = 0;  
        }

        function showInstantFeedback() {
            if (currentTestQuestions.length === 0 || currentQuestionIndex >= currentTestQuestions.length) return;
            const question = currentTestQuestions[currentQuestionIndex];
            const userAnswer = userAnswers[question.id];
            if (userAnswer === undefined) { instantFeedback.style.display = 'none'; return; }
            const isCorrect = userAnswer === question.correta;
            instantFeedback.textContent = isCorrect ? `✅ Resposta correta! (${question.correta.toUpperCase()})` : `❌ Resposta incorreta! A correta é ${question.correta.toUpperCase()}`;
            instantFeedback.className = isCorrect ? 'instant-feedback correct' : 'instant-feedback incorrect';
            instantFeedback.style.display = 'block';
            setTimeout(() => instantFeedback.scrollIntoView({ behavior: 'smooth', block: 'center' }), 100);
        }

        function updateProgressBar() {
            const progress = currentTestQuestions.length > 0 ? (answeredQuestions / currentTestQuestions.length) * 100 : 0;
            progressBar.style.width = `${progress}%`;
        }

        function updateNavigationButtons() {
            prevBtn.disabled = currentQuestionIndex === 0;
            const questionId = currentTestQuestions[currentQuestionIndex]?.id;
            const answeredCurrent = userAnswers[questionId] !== undefined;
            
            if (currentQuestionIndex === currentTestQuestions.length - 1) { // Se é a última questão
                nextBtn.style.display = 'none';
                finishBtn.style.display = 'block';
                finishBtn.disabled = !answeredCurrent; // Habilita finalizar apenas se a última foi respondida
            } else { // Não é a última questão
                nextBtn.style.display = 'block';
                finishBtn.style.display = 'none';
                nextBtn.disabled = !answeredCurrent; // Habilita próxima apenas se a atual foi respondida
            }
            if(currentQuestionIndex > 0) prevBtn.disabled = false; // Se não for a primeira, botão anterior sempre habilitado
        }

        function nextQuestion() {
            showInstantFeedback(); 

            if (showFeedbackOnNext) { 
                showBlockFeedback(); 
            } else {
                if (currentQuestionIndex < currentTestQuestions.length - 1) {
                    setTimeout(() => { 
                        currentQuestionIndex++;
                        displayCurrentQuestion();
                    }, 300); // Delay apenas se não houver feedback de bloco
                }
            }
        }


        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                displayCurrentQuestion();
            }
        }
        
        function finishTest() {
            const currentQuestionId = currentTestQuestions[currentQuestionIndex]?.id;
            if(userAnswers[currentQuestionId] === undefined && currentQuestionIndex === currentTestQuestions.length -1) {
                alert("Por favor, responda à questão atual antes de finalizar.");
                return; 
            }

            showInstantFeedback(); 

            if (showFeedbackOnNext && currentQuestionIndex === currentTestQuestions.length - 1) {
                showBlockFeedback(); 
            } else {
                actuallyFinishTest(); 
            }
        }

        function actuallyFinishTest() {
             if (hasFinishedCurrentTestProcessing) {
                console.warn("actuallyFinishTest: Processamento já realizado para esta tentativa. Exibindo resultados existentes.");
                const lastAttempt = testStatistics.attemptsHistory && testStatistics.attemptsHistory.length > 0 
                                     ? testStatistics.attemptsHistory[testStatistics.attemptsHistory.length -1]
                                     : null;
                if(lastAttempt && typeof lastAttempt.total === 'number' && lastAttempt.total > 0) { 
                    showResultsPage(parseFloat(lastAttempt.score), (lastAttempt.correct / lastAttempt.total) * 100, lastAttempt.correct, lastAttempt.total);
                } else { 
                    showResultsPage(0, 0, 0, 0); 
                }
                return;
            }


            const delay = userAnswers[currentTestQuestions[currentQuestionIndex]?.id] !== undefined ? 300 : 0;
            setTimeout(() => {
                // currentFileId é sempre EMBEDDED_QUIZ_ID, não precisa checar se é null
                
                testStatistics.correct = [];
                testStatistics.incorrect = [];
                testStatistics.performanceByArea = {}; 
                
                currentTestQuestions.forEach((question) => {
                    const userAnswer = userAnswers[question.id]; 
                    if (userAnswer === undefined) return; 

                    if (question.area) {
                        if (!testStatistics.performanceByArea[question.area]) {
                            testStatistics.performanceByArea[question.area] = { correct: 0, total: 0 };
                        }
                        testStatistics.performanceByArea[question.area].total++;
                    }

                    if (userAnswer === question.correta) {
                        testStatistics.correct.push(question.id);
                        if (question.area) {
                            testStatistics.performanceByArea[question.area].correct++;
                        }
                    } else {
                        testStatistics.incorrect.push(question.id);
                        testStatistics.questionMistakes[question.id] = (testStatistics.questionMistakes[question.id] || 0) + 1;
                    }
                });
                
                const correctCount = testStatistics.correct.length;
                const totalAnsweredInTest = correctCount + testStatistics.incorrect.length;
                
                const correctPercentage = totalAnsweredInTest > 0 ? ((correctCount / totalAnsweredInTest) * 100) : 0; 
                const finalScore = totalAnsweredInTest > 0 ? ((correctCount / totalAnsweredInTest) * 10) : 0; 
                
                if (totalAnsweredInTest > 0) { // Salva no histórico apenas se houver respostas
                    if (!testStatistics.attemptsHistory) testStatistics.attemptsHistory = [];
                    testStatistics.attemptsHistory.push({
                        date: new Date().toLocaleString(),
                        correct: correctCount,
                        total: totalAnsweredInTest,
                        score: finalScore.toFixed(1),
                        attemptNumber: testStatistics.attemptCount, 
                        questionIdsInAttempt: currentTestQuestions.map(q => q.id),
                        userAnswersInAttempt: {...userAnswers} 
                    });
                }
                
                saveStats(testStatistics); // Salva estatísticas atualizadas
                hasFinishedCurrentTestProcessing = true; 
                showResultsPage(finalScore, correctPercentage, correctCount, totalAnsweredInTest);
            }, delay);
        }

        function showResultsPage(score, percentage, correctCount, totalAttempted) {
            quizPage.style.display = 'none';
            resultsPage.style.display = 'block';

            const resultsMainBox = document.getElementById('results-main-box');
            resultsMainBox.classList.remove('results-box-bad', 'results-box-average', 'results-box-good');
            if (score < 6) {
                resultsMainBox.classList.add('results-box-bad');
            } else if (score < 8) {
                resultsMainBox.classList.add('results-box-average');
            } else {
                resultsMainBox.classList.add('results-box-good');
            }

            const finalScoreBox = document.getElementById('finalScoreText');
            finalScoreBox.textContent = `${score.toFixed(1)}`;
            finalScoreBox.className = 'final-score-value-box'; 
            if (score < 6) {
                finalScoreBox.classList.add('score-bad');
            } else if (score < 8) {
                finalScoreBox.classList.add('score-average');
            } else {
                finalScoreBox.classList.add('score-good');
            }
            
            finalPercentageText.innerHTML = `Você acertou <strong>${correctCount}</strong> de <strong>${totalAttempted}</strong> questões respondidas (<strong>${percentage.toFixed(1)}%</strong>)`;
            
            destroyCharts();
            generateCharts(); 
            generateQuestionsAnalysis(); 
            resetStatsBtn.disabled = false; // Habilita o botão de reset, pois há um resultado para o simulado
            
            const resultsTitleEl = document.getElementById('resultsTitle');
            if(resultsTitleEl) {
                resultsTitleEl.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        function destroyCharts() { 
            Object.keys(charts).forEach(key => {
                if (charts[key] && typeof charts[key].destroy === 'function') {
                    charts[key].destroy();
                }
                charts[key] = null;
            });
        }
        
        function updateCharts() { 
            destroyCharts(); 
            setTimeout(() => {
                generateCharts();
            }, 50);
        }

        function generateCharts() {
            // currentFileId é sempre EMBEDDED_QUIZ_ID, não precisa checar
            destroyCharts(); 
            
            const textColor = getComputedStyle(document.body).getPropertyValue('--text-primary').trim();
            const borderColorCSS = getComputedStyle(document.body).getPropertyValue('--border-color').trim();
            const correctColor = getComputedStyle(document.body).getPropertyValue('--accent-color').trim();
            const incorrectColor = getComputedStyle(document.body).getPropertyValue('--danger-color').trim();
            const primaryColor = getComputedStyle(document.body).getPropertyValue('--primary-color').trim();
            const bgCardColor = getComputedStyle(document.body).getPropertyValue('--bg-card').trim();

            const correctAnswersCount = testStatistics.correct.length;
            const incorrectAnswersCount = testStatistics.incorrect.length;

            // Gráfico de Desempenho Geral (Pizza)
            if (correctAnswersCount > 0 || incorrectAnswersCount > 0) { // Só mostra se houver dados
                charts.performance = new Chart(document.getElementById('performanceChart').getContext('2d'), {
                    type: 'pie',
                    data: {
                        labels: ['Acertos', 'Erros'],
                        datasets: [{
                            data: [correctAnswersCount, incorrectAnswersCount],
                            backgroundColor: [correctColor, incorrectColor],
                            borderColor: bgCardColor, borderWidth: 2
                        }]
                    },
                    options: getChartOptions('Desempenho na Prova Atual', textColor)
                });
            }


            // Gráfico de Progresso nas Tentativas (Barras)
            const attemptLabels = (testStatistics.attemptsHistory || []).map((a, i) => `Tent. ${a.attemptNumber || i + 1}`);
            const attemptScores = (testStatistics.attemptsHistory || []).map(a => parseFloat(a.score));
            if (attemptLabels.length > 0) { // Só mostra se houver histórico
                charts.progress = new Chart(document.getElementById('progressChart').getContext('2d'), {
                    type: 'bar', 
                    data: {
                        labels: attemptLabels,
                        datasets: [{
                            label: 'Nota (0-10)', 
                            data: attemptScores, 
                            backgroundColor: primaryColor + 'B3', 
                            borderColor: primaryColor,
                            borderWidth: 1
                        }]
                    },
                    options: getChartOptions('Progresso nas Tentativas (Neste Simulado)', textColor, {
                        scales: { 
                            y: { beginAtZero: true, max: 10, ticks: { color: textColor, stepSize: 1 }, grid: { color: borderColorCSS + '80' } },
                            x: { ticks: { color: textColor }, grid: { color: borderColorCSS + '80' } } 
                        },
                        animation: { // Para mostrar o valor em cima da barra
                            onComplete: function() {
                                const chartInstance = this;
                                const ctx = chartInstance.ctx;
                                const fontFam = getComputedStyle(document.body).getPropertyValue('--font-main').split(',')[0].trim() || 'Poppins';
                                ctx.font = `600 11px ${fontFam}`;
                                ctx.textAlign = 'center';
                                ctx.textBaseline = 'bottom';
                                ctx.fillStyle = textColor;

                                this.data.datasets.forEach(function(dataset, i) {
                                    const meta = chartInstance.getDatasetMeta(i);
                                    if (!meta.hidden) {
                                        meta.data.forEach(function(bar, index) {
                                            const data = dataset.data[index];
                                            if (data !== null && data !== undefined) {
                                                const score = parseFloat(data).toFixed(1);
                                                ctx.fillText(score, bar.x, bar.y - 6); 
                                            }
                                        });
                                    }
                                });
                            }
                        }
                    })
                });
            }
            
            // Gráfico de Acertos por Área (Barras Horizontais)
            const areaLabels = Object.keys(testStatistics.performanceByArea || {});
            const areaPerformance = areaLabels.map(area => {
                const data = testStatistics.performanceByArea[area];
                return data.total > 0 ? (data.correct / data.total) * 100 : 0;
            });
            
            const areasChartCard = document.getElementById('areasChartCard');
            if (areasChartCard && areaLabels.length > 0) { // Só mostra se houver áreas e dados
                areasChartCard.style.display = 'block'; 
                charts.areas = new Chart(document.getElementById('areasChart').getContext('2d'), {
                    type: 'bar',
                    data: {
                        labels: areaLabels,
                        datasets: [{
                            label: '% Acerto por Área (Prova Atual)', data: areaPerformance, backgroundColor: primaryColor + 'B3',
                            borderColor: primaryColor, borderWidth: 1
                        }]
                    },
                    options: getChartOptions('Desempenho por Área (Prova Atual)', textColor, {
                        indexAxis: 'y',
                        scales: { 
                            y: { ticks: { color: textColor }, grid: { color: borderColorCSS + '80' } },
                            x: { beginAtZero: true, max: 100, ticks: { color: textColor, callback: function(value) { return value + "%" } }, grid: { color: borderColorCSS + '80' } }
                        }
                    })
                });
            } else if (areasChartCard) {
                areasChartCard.style.display = 'none'; 
            }

            // Gráfico de Questões Mais Erradas (Barras)
            const mistakeCountsOverall = {};
            Object.entries(testStatistics.questionMistakes || {}).forEach(([qId, count]) => {
                if (count > 0) {
                    const originalQuestionIndex = allQuestions.findIndex(q => q.id === qId); 
                    if (originalQuestionIndex !== -1) { 
                        mistakeCountsOverall[`Q${originalQuestionIndex + 1}`] = count;
                    }
                }
            });
            const sortedMistakesOverall = Object.entries(mistakeCountsOverall)
                                                 .sort(([,a],[,b]) => b-a) // Ordena por mais erradas
                                                 .slice(0,10); // Pega o Top 10
            
            if (sortedMistakesOverall.length > 0) { // Só mostra se houver erros
                charts.mistakes = new Chart(document.getElementById('mistakesChart').getContext('2d'), {
                    type: 'bar',
                    data: {
                        labels: sortedMistakesOverall.map(item => item[0]),
                        datasets: [{
                            label: 'Vezes Erradas (Top 10 - Este Simulado)', data: sortedMistakesOverall.map(item => item[1]),
                            backgroundColor: incorrectColor + 'B3', borderColor: incorrectColor, borderWidth: 1
                        }]
                    },
                    options: getChartOptions('Questões Mais Erradas (Este Simulado)', textColor, {
                        scales: { 
                            y: { beginAtZero: true, ticks: { color: textColor, stepSize: 1 }, grid: { color: borderColorCSS + '80' } },
                            x: { ticks: { color: textColor }, grid: { color: borderColorCSS + '80' } } 
                        },
                        onClick: (event, elements) => { 
                            if (elements.length > 0) {
                                const chartElement = elements[0];
                                const index = chartElement.index;
                                const questionLabel = charts.mistakes.data.labels[index]; 
                                const questionNumberStr = questionLabel.substring(1); 
                                const questionNumber = parseInt(questionNumberStr); 
                                if (!isNaN(questionNumber) && questionNumber > 0 && questionNumber <= allQuestions.length) {
                                    const questionData = allQuestions[questionNumber - 1]; 
                                    displayQuestionInPopup(questionData);
                                } else {
                                    console.error("Não foi possível encontrar a questão para o label:", questionLabel);
                                }
                            }
                        }
                    })
                });
            }
            generateAdditionalCharts();
        }

        function generateAdditionalCharts() {
            const textColor = getComputedStyle(document.body).getPropertyValue('--text-primary').trim();
            const borderColorCSS = getComputedStyle(document.body).getPropertyValue('--border-color').trim();
            const bgCardColor = getComputedStyle(document.body).getPropertyValue('--bg-card').trim();

            // Gráfico de Tamanho da Questão
            const SMALL_Q_THRESHOLD_NEW = 400; 
            const MEDIUM_Q_THRESHOLD_NEW = 800; 
            let smallQ = 0, mediumQ = 0, longQ = 0;
            
            currentTestQuestions.forEach(q => {
                let totalLength = q.enunciado ? q.enunciado.length : 0;
                if (q.alternativas) {
                    Object.values(q.alternativas).forEach(altText => {
                        if (altText) totalLength += altText.length;
                    });
                }
                if (totalLength < SMALL_Q_THRESHOLD_NEW) smallQ++;
                else if (totalLength < MEDIUM_Q_THRESHOLD_NEW) mediumQ++;
                else longQ++;
            });

            const qSizeColors = [
                'rgba(75, 192, 192, 0.7)',  
                'rgba(255, 206, 86, 0.7)', 
                'rgba(255, 99, 132, 0.7)'   
            ];
            const qSizeBorderColors = [
                'rgba(75, 192, 192, 1)',
                'rgba(255, 206, 86, 1)',
                'rgba(255, 99, 132, 1)'
            ];

            if (smallQ > 0 || mediumQ > 0 || longQ > 0) {
                charts.questionSizeChart = new Chart(document.getElementById('questionSizeChart').getContext('2d'), {
                    type: 'bar', 
                    data: {
                        labels: [`Pequenas (<${SMALL_Q_THRESHOLD_NEW}c)`, `Médias (${SMALL_Q_THRESHOLD_NEW}-${MEDIUM_Q_THRESHOLD_NEW}c)`, `Longas (>${MEDIUM_Q_THRESHOLD_NEW}c)`],
                        datasets: [{ 
                            label: 'Quantidade de Questões', 
                            data: [smallQ, mediumQ, longQ],
                            backgroundColor: qSizeColors,
                            borderColor: qSizeBorderColors,
                            borderWidth: 1 
                        }]
                    },
                    options: getChartOptions('Tamanho de Questão (Enunciado + Alternativas)', textColor, {
                        indexAxis: 'y', 
                        scales: { 
                            x: { beginAtZero: true, ticks: { color: textColor, stepSize: Math.max(1, Math.ceil(Math.max(1, smallQ,mediumQ,longQ) / 5)) }, grid: { color: borderColorCSS + '80' } }, 
                            y: { ticks: { color: textColor }, grid: { display: false } } 
                        },
                        plugins: { legend: { display: false } }
                    })
                });
            }


            // Gráfico de Tempo por Questão (Simulado - dados fictícios por enquanto)
            const timeLabels = currentTestQuestions.slice(0,10).map((q,i) => { // Mostra para as 10 primeiras da prova atual
                const globalIndex = allQuestions.findIndex(aq => aq.id === q.id);
                return `Q${globalIndex !== -1 ? globalIndex + 1 : i + 1}`; // Usa o índice global se possível
            });
            // TODO: Implementar medição real de tempo por questão se desejado.
            // Por agora, dados aleatórios apenas para visualização.
            const timeData = Array.from({length: timeLabels.length}, () => Math.floor(Math.random() * 90) + 30); 
            
            if (timeLabels.length > 0) {
                charts.timePerQuestion = new Chart(document.getElementById('timePerQuestionChart').getContext('2d'), {
                    type: 'bar',
                    data: {
                        labels: timeLabels,
                        datasets: [{ 
                            label: 'Tempo (s)', 
                            data: timeData,
                            backgroundColor: 'rgba(54, 162, 235, 0.7)', 
                            borderColor: 'rgba(54, 162, 235, 1)',
                            borderWidth: 1 
                        }]
                    },
                    options: getChartOptions('Tempo por Questão (Simulado - Amostra)', textColor, {
                        scales: { 
                            y: { beginAtZero: true, ticks: { color: textColor }, grid: { color: borderColorCSS + '80' } },
                            x: { ticks: { color: textColor }, grid: { color: borderColorCSS + '80' } } 
                        },
                        plugins: { legend: { display: false } }
                    })
                });
            }
        }

        function getChartOptions(title, textColor, customOptions = {}) {
            const gridColor = getComputedStyle(document.body).getPropertyValue('--border-color').trim() + '60'; // Grid mais sutil

            return {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom',
                        labels: { color: textColor, font: { family: 'Poppins', size: 12 } }
                    },
                    title: { display: true, text: title, color: textColor, font: { family: 'Poppins', size: 14, weight: '600' }, padding: {bottom: 10} }
                },
                scales: customOptions.scales ? { // Configuração de eixos se fornecida
                    y: {
                        ...(customOptions.scales.y || {}),
                        ticks: { ...(customOptions.scales.y?.ticks || {}), color: textColor },
                        grid: { ...(customOptions.scales.y?.grid || {}), color: gridColor, drawBorder: false }
                    },
                    x: {
                        ...(customOptions.scales.x || {}),
                        ticks: { ...(customOptions.scales.x?.ticks || {}), color: textColor },
                        grid: { ...(customOptions.scales.x?.grid || {}), color: gridColor, drawBorder: false }
                    }
                } : undefined, // Se não houver custom scales, não define a propriedade scales (útil para gráficos de pizza)
                ...customOptions // Permite sobrescrever ou adicionar outras opções
            };
        }
        
        function displayQuestionInPopup(question) {
            let imageHtml = question.imagem && question.imagem !== 'null' ? `<img src="${question.imagem}" alt="Imagem da questão" class="question-image" style="max-height: 200px; margin-bottom: 15px;">` : '';
            
            let optionsHtml = '<div class="options" style="gap: 8px; pointer-events: none;">'; // Desabilita cliques nas opções do popup
            Object.entries(question.alternativas).forEach(([letter, text]) => {
                let optClass = 'option';
                let optInnerStyle = 'margin-bottom: 8px; border-width: 1px; padding: 10px;';
                
                if (letter === question.correta) {
                    optClass += ' correct'; 
                    // Estilo para destacar a correta no popup
                    optInnerStyle += `background-color: var(--accent-light); border-left-color: var(--accent-color); border-left-width: 4px;`;
                } else {
                     optInnerStyle += `background-color: transparent;`; 
                }

                optionsHtml += `<div class="${optClass}" style="${optInnerStyle}">
                                     <span class="option-letter-styled">${letter.toUpperCase()})</span>
                                     <span class="option-actual-text" style="color: var(--text-primary);">${text}</span>
                                 </div>`;
            });
            optionsHtml += '</div>';

            const formattedEnunciado = formatEnunciado(question.enunciado);
            const formattedExplicacao = question.explicacao ? formatEnunciado(question.explicacao) : '';

            questionDetailContent.innerHTML = `
                <div class="question-container" style="border: none; box-shadow: none; padding:0; margin-bottom:0;">
                    <h4 style="color: var(--primary-color); text-align:left; margin-bottom:10px;">Detalhe da Questão</h4>
                    <div class="question-text" style="margin-bottom:15px; font-size: 1rem;">${formattedEnunciado}</div>
                    ${imageHtml}
                    ${optionsHtml}
                    ${formattedExplicacao ? `<div class="explanation" style="display:block; margin-top: 15px; padding:10px; background-color: var(--bg-main); border-radius: 6px;"><strong style="color:var(--text-secondary);">Explicação:</strong><br>${formattedExplicacao}</div>` : ''}
                </div>
            `;
            questionDetailPopup.classList.add('active');
        }

        function closeQuestionDetailPopup() {
            questionDetailPopup.classList.remove('active');
            questionDetailContent.innerHTML = ''; 
        }

        function generateQuestionsAnalysis() {
            questionsAnalysis.innerHTML = ''; 
            currentTestQuestions.forEach((question, index) => {
                const userAnswer = userAnswers[question.id]; 
                if (userAnswer === undefined) return; // Só analisa questões respondidas na tentativa atual

                const isCorrect = userAnswer === question.correta;
                const questionDiv = document.createElement('div');
                
                questionDiv.className = `question-container ${isCorrect ? 'correct' : 'incorrect'}`;
                questionDiv.style.marginBottom = '20px';

                let imageHtml = question.imagem && question.imagem !== 'null' ? `<img src="${question.imagem}" alt="Imagem da questão" class="question-image">` : '';
                
                let optionsHtml = Object.entries(question.alternativas).map(([letter, text]) => {
                    let optClass = 'option'; 
                    let optStyle = 'pointer-events: none; transform: none; margin-bottom: 8px; border-width: 1px;'; 

                    if (letter === question.correta) optClass += ' correct'; 
                    if (letter === userAnswer && !isCorrect) optClass += ' selected incorrect'; 
                    else if (letter === userAnswer && isCorrect) optClass += ' selected';

                    return `<div class="${optClass}" style="${optStyle}">
                                 <span class="option-letter-styled">${letter.toUpperCase()})</span>
                                 <span class="option-actual-text" style="color: var(--text-primary);">${text}</span>
                             </div>`;
                }).join('');

                let correctAnswerBox = '';
                if (!isCorrect) { // Mostra a caixa de resposta correta apenas se o usuário errou
                    correctAnswerBox = `<div class="analysis-correct-answer">
                        <strong>Resposta Correta: ${question.correta.toUpperCase()})</strong> ${question.alternativas[question.correta]}
                    </div>`;
                }

                const formattedEnunciado = formatEnunciado(question.enunciado);
                const formattedExplicacao = question.explicacao ? formatEnunciado(question.explicacao) : '';

                questionDiv.innerHTML = `
                    <div class="question-number">Questão ${index + 1} - ${isCorrect ? 'Acertou' : 'Errou'}</div>
                    <div class="question-text" style="margin-bottom:15px;">${formattedEnunciado}</div>
                    ${imageHtml}
                    <div class="options" style="gap: 0;">${optionsHtml}</div>
                    ${correctAnswerBox} 
                    ${formattedExplicacao ? `<div class="explanation" style="display:block; margin-top: 15px;">${formattedExplicacao}</div>` : ''}`;
                questionsAnalysis.appendChild(questionDiv);
            });
        }
        
        function startNewAttempt(isMistakesQuizForce = false) {
            if (allQuestions.length === 0) { 
                alert("Nenhuma questão carregada. Verifique a configuração das questões embutidas.");
                return;
            }
            
             if (quizStartOptionsPopup.classList.contains('active')) {
                closeQuizOptionsPopup();
            }
            
            if (isMistakesQuizForce) {
                const distinctMistakesCount = Object.values(testStatistics.questionMistakes || {}).filter(count => count > 0).length;
                if (distinctMistakesCount > 0) { 
                    initializeTest(true, 10); 
                } else {
                     alert("Não há questões erradas para revisar neste simulado. Iniciando prova normal.");
                    initializeTest(false, Math.min(40, allQuestions.length));
                }
            } else {
                initializeTest(false, Math.min(40, allQuestions.length));
            }
        }

        // REMOVIDA: function loadNewFile() { location.reload(); }

        document.addEventListener('DOMContentLoaded', () => {
            quizPage.style.display = 'none'; 
            resultsPage.style.display = 'none'; // Esconde a página de resultados inicialmente
            
            loadEmbeddedQuizAndShowOptions(); // Carrega o simulado embutido e mostra opções

            if (document.body.classList.contains('dark-mode')) {
                darkModeText.textContent = 'Modo Claro';
                darkModeTextResults.textContent = 'Modo Claro';
            } else {
                darkModeText.textContent = 'Modo Escuro';
                darkModeTextResults.textContent = 'Modo Escuro';
            }
        });

    </script>
</body>
</html>
